Iteration 0: 100%|██████████| 5/5 [00:11<00:00,  2.35s/it]
Agent gate_2 episode reward: [-46.46549336]
All agents episode reward: [-46.46549336]
Agent gate_2 episode reward: [-1.46282808]
All agents episode reward: [-1.46282808]
Agent gate_2 episode reward: [-1.10325158]
All agents episode reward: [-1.10325158]
Agent gate_2 episode reward: [-0.96231281]
All agents episode reward: [-0.96231281]
Agent gate_2 episode reward: [-0.92891475]
All agents episode reward: [-0.92891475]
Iteration 1: 100%|██████████| 5/5 [00:11<00:00,  2.25s/it]
Agent gate_2 episode reward: [-0.92010131]
All agents episode reward: [-0.92010131]
Agent gate_2 episode reward: [-0.90465566]
All agents episode reward: [-0.90465566]
Agent gate_2 episode reward: [-0.39325653]
All agents episode reward: [-0.39325653]
Agent gate_2 episode reward: [-0.21001654]
All agents episode reward: [-0.21001654]
Agent gate_2 episode reward: [-8.37430256]
All agents episode reward: [-8.37430256]
Iteration 2: 100%|██████████| 5/5 [00:11<00:00,  2.25s/it]
Agent gate_2 episode reward: [-0.40322794]
All agents episode reward: [-0.40322794]
Agent gate_2 episode reward: [-0.56835261]
All agents episode reward: [-0.56835261]
Agent gate_2 episode reward: [-0.57977301]
All agents episode reward: [-0.57977301]
Agent gate_2 episode reward: [-0.58086932]
All agents episode reward: [-0.58086932]
Agent gate_2 episode reward: [-0.61730068]
All agents episode reward: [-0.61730068]
Iteration 3: 100%|██████████| 5/5 [00:11<00:00,  2.21s/it]
Agent gate_2 episode reward: [-0.63053498]
All agents episode reward: [-0.63053498]
Agent gate_2 episode reward: [-0.54829048]
All agents episode reward: [-0.54829048]
Agent gate_2 episode reward: [-0.58817762]
All agents episode reward: [-0.58817762]
Agent gate_2 episode reward: [-0.61042364]
All agents episode reward: [-0.61042364]
Agent gate_2 episode reward: [-0.60246766]
All agents episode reward: [-0.60246766]
Iteration 4: 100%|██████████| 5/5 [00:11<00:00,  2.22s/it]
Agent gate_2 episode reward: [-0.6310841]
All agents episode reward: [-0.6310841]
Agent gate_2 episode reward: [-0.32596386]
All agents episode reward: [-0.32596386]
Agent gate_2 episode reward: [-42.12708398]
All agents episode reward: [-42.12708398]
Agent gate_2 episode reward: [-22.39781468]
All agents episode reward: [-22.39781468]
Agent gate_2 episode reward: [-0.03154182]
All agents episode reward: [-0.03154182]
Iteration 5: 100%|██████████| 5/5 [00:14<00:00,  2.96s/it]
Agent gate_2 episode reward: [-0.06717696]
All agents episode reward: [-0.06717696]
Agent gate_2 episode reward: [-0.05159961]
All agents episode reward: [-0.05159961]
Agent gate_2 episode reward: [-0.07012427]
All agents episode reward: [-0.07012427]
Agent gate_2 episode reward: [-0.06592893]
All agents episode reward: [-0.06592893]
Saved 1 agents to ppo_agents_butterfly_scC
[Validation] New best avg return: -169535.297 at episode 30 (over 5 val episodes, saved to ppo_agents_butterfly_scC)
Agent gate_2 episode reward: [-0.0771723]
All agents episode reward: [-0.0771723]
Iteration 6: 100%|██████████| 5/5 [00:11<00:00,  2.31s/it]
Agent gate_2 episode reward: [-0.07681905]
All agents episode reward: [-0.07681905]
Agent gate_2 episode reward: [-0.08286856]
All agents episode reward: [-0.08286856]
Agent gate_2 episode reward: [-0.07862414]
All agents episode reward: [-0.07862414]
Agent gate_2 episode reward: [-0.078949]
All agents episode reward: [-0.078949]
Agent gate_2 episode reward: [-0.08394696]
All agents episode reward: [-0.08394696]
Iteration 7: 100%|██████████| 5/5 [00:16<00:00,  3.39s/it]
Agent gate_2 episode reward: [-0.0796621]
All agents episode reward: [-0.0796621]
Agent gate_2 episode reward: [-0.08824725]
All agents episode reward: [-0.08824725]
Agent gate_2 episode reward: [-0.0794838]
All agents episode reward: [-0.0794838]
Agent gate_2 episode reward: [-0.09109595]
All agents episode reward: [-0.09109595]
Saved 1 agents to ppo_agents_butterfly_scC
[Validation] New best avg return: -168852.641 at episode 40 (over 5 val episodes, saved to ppo_agents_butterfly_scC)
Agent gate_2 episode reward: [-0.08167077]
All agents episode reward: [-0.08167077]
Iteration 8: 100%|██████████| 5/5 [00:11<00:00,  2.23s/it]
Agent gate_2 episode reward: [-0.09378068]
All agents episode reward: [-0.09378068]
Agent gate_2 episode reward: [-0.08103787]
All agents episode reward: [-0.08103787]
Agent gate_2 episode reward: [-0.08318796]
All agents episode reward: [-0.08318796]
Agent gate_2 episode reward: [-0.1069175]
All agents episode reward: [-0.1069175]
Agent gate_2 episode reward: [-0.08816588]
All agents episode reward: [-0.08816588]
Iteration 9: 100%|██████████| 5/5 [00:14<00:00,  2.99s/it]
Agent gate_2 episode reward: [-0.10479796]
All agents episode reward: [-0.10479796]
Agent gate_2 episode reward: [-0.10214578]
All agents episode reward: [-0.10214578]
Agent gate_2 episode reward: [-0.09576435]
All agents episode reward: [-0.09576435]
Agent gate_2 episode reward: [-0.10030859]
All agents episode reward: [-0.10030859]
Agent gate_2 episode reward: [-0.10579178]
All agents episode reward: [-0.10579178]
Loaded 1 agents from ppo_agents_butterfly_scC
Running 10 evaluation runs...
  Run 1/10... Avg agent reward (episode): -168852.641 | Total reward: -168852.641
Saved run 1 to rl_training/butterfly_scC/ppo_run1
  Run 2/10... Avg agent reward (episode): -392408.938 | Total reward: -392408.938
Saved run 2 to rl_training/butterfly_scC/ppo_run2
  Run 3/10... Avg agent reward (episode): -267432.750 | Total reward: -267432.750
Saved run 3 to rl_training/butterfly_scC/ppo_run3
  Run 4/10... Avg agent reward (episode): -705950.812 | Total reward: -705950.812
Saved run 4 to rl_training/butterfly_scC/ppo_run4
  Run 5/10... Avg agent reward (episode): -488222.125 | Total reward: -488222.125
Saved run 5 to rl_training/butterfly_scC/ppo_run5
  Run 6/10... Avg agent reward (episode): -386859.375 | Total reward: -386859.375
Saved run 6 to rl_training/butterfly_scC/ppo_run6
  Run 7/10... Avg agent reward (episode): -385857.688 | Total reward: -385857.688
Saved run 7 to rl_training/butterfly_scC/ppo_run7
  Run 8/10... Avg agent reward (episode): -263914.656 | Total reward: -263914.656
Saved run 8 to rl_training/butterfly_scC/ppo_run8
  Run 9/10... Avg agent reward (episode): -620242.562 | Total reward: -620242.562
Saved run 9 to rl_training/butterfly_scC/ppo_run9
  Run 10/10... Avg agent reward (episode): -177865.828 | Total reward: -177865.828
Saved run 10 to rl_training/butterfly_scC/ppo_run10
============================================================
Evaluation Results
  Number of runs: 10
============================================================
  Agent gate_2: -385760.719 ± 169459.297
  Average reward: -385760.719 ± 169459.297
  Total reward: -385760.719 ± 169459.297
============================================================
Running 10 evaluation runs...
  Run 1/10... Avg agent reward (episode): -169535.297 | Total reward: -169535.297
Saved run 1 to rl_training/butterfly_scC/rule_based_run1
  Run 2/10... Avg agent reward (episode): -430968.125 | Total reward: -430968.125
Saved run 2 to rl_training/butterfly_scC/rule_based_run2
  Run 3/10... Avg agent reward (episode): -261456.281 | Total reward: -261456.281
Saved run 3 to rl_training/butterfly_scC/rule_based_run3
  Run 4/10... Avg agent reward (episode): -705950.812 | Total reward: -705950.812
Saved run 4 to rl_training/butterfly_scC/rule_based_run4
  Run 5/10... Avg agent reward (episode): -488222.125 | Total reward: -488222.125
Saved run 5 to rl_training/butterfly_scC/rule_based_run5
  Run 6/10... Avg agent reward (episode): -366496.125 | Total reward: -366496.125
Saved run 6 to rl_training/butterfly_scC/rule_based_run6
  Run 7/10... Avg agent reward (episode): -385857.688 | Total reward: -385857.688
Saved run 7 to rl_training/butterfly_scC/rule_based_run7
  Run 8/10... Avg agent reward (episode): -257767.312 | Total reward: -257767.312
Saved run 8 to rl_training/butterfly_scC/rule_based_run8
  Run 9/10... Avg agent reward (episode): -676446.500 | Total reward: -676446.500
Saved run 9 to rl_training/butterfly_scC/rule_based_run9
  Run 10/10... Avg agent reward (episode): -177865.828 | Total reward: -177865.828
Saved run 10 to rl_training/butterfly_scC/rule_based_run10
============================================================
Evaluation Results
  Number of runs: 10
============================================================
  Agent gate_2: -392056.594 ± 179260.812
  Average reward: -392056.594 ± 179260.812
  Total reward: -392056.594 ± 179260.812
============================================================
Running 10 evaluation runs...
  Run 1/10... No actions provided, skipping action application.
Avg agent reward (episode): -169535.297 | Total reward: -169535.297
Saved run 1 to rl_training/butterfly_scC/no_control_run1
  Run 2/10... No actions provided, skipping action application.
Avg agent reward (episode): -430968.125 | Total reward: -430968.125
Saved run 2 to rl_training/butterfly_scC/no_control_run2
  Run 3/10... No actions provided, skipping action application.
Avg agent reward (episode): -261456.281 | Total reward: -261456.281
Saved run 3 to rl_training/butterfly_scC/no_control_run3
  Run 4/10... No actions provided, skipping action application.
Avg agent reward (episode): -705950.812 | Total reward: -705950.812
Saved run 4 to rl_training/butterfly_scC/no_control_run4
  Run 5/10... No actions provided, skipping action application.
Avg agent reward (episode): -488222.125 | Total reward: -488222.125
Saved run 5 to rl_training/butterfly_scC/no_control_run5
  Run 6/10... No actions provided, skipping action application.
Avg agent reward (episode): -366496.125 | Total reward: -366496.125
Saved run 6 to rl_training/butterfly_scC/no_control_run6
  Run 7/10... No actions provided, skipping action application.
Avg agent reward (episode): -385857.688 | Total reward: -385857.688
Saved run 7 to rl_training/butterfly_scC/no_control_run7
  Run 8/10... No actions provided, skipping action application.
Avg agent reward (episode): -257767.312 | Total reward: -257767.312
Saved run 8 to rl_training/butterfly_scC/no_control_run8
  Run 9/10... No actions provided, skipping action application.
Avg agent reward (episode): -676446.500 | Total reward: -676446.500
Saved run 9 to rl_training/butterfly_scC/no_control_run9
  Run 10/10... No actions provided, skipping action application.
Avg agent reward (episode): -177865.828 | Total reward: -177865.828
Saved run 10 to rl_training/butterfly_scC/no_control_run10
============================================================
Evaluation Results
  Number of runs: 10
============================================================
  Agent gate_2: -392056.594 ± 179260.812
  Average reward: -392056.594 ± 179260.812
  Total reward: -392056.594 ± 179260.812
============================================================

============================================================
Comparison of All Methods
============================================================
ppo avg reward:        -385760.719
Rule-based avg reward: -392056.594
No control avg reward: -392056.594
============================================================
/Users/mmai/anaconda3/envs/control/lib/python3.11/site-packages/matplotlib/patches.py:3421: RuntimeWarning: invalid value encountered in scalar divide
  cos_t, sin_t = head_length / head_dist, head_width / head_dist
