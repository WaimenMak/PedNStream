Iteration 0: 100%|██████████| 5/5 [00:11<00:00,  2.35s/it]
Agent gate_2 episode reward: [-74.61089351]
All agents episode reward: [-74.61089351]
Agent gate_2 episode reward: [-0.34042924]
All agents episode reward: [-0.34042924]
Agent gate_2 episode reward: [-0.97930457]
All agents episode reward: [-0.97930457]
Agent gate_2 episode reward: [-1.87277093]
All agents episode reward: [-1.87277093]
Agent gate_2 episode reward: [-0.05966544]
All agents episode reward: [-0.05966544]
Iteration 1: 100%|██████████| 5/5 [00:11<00:00,  2.29s/it]
Agent gate_2 episode reward: [-0.02825309]
All agents episode reward: [-0.02825309]
Agent gate_2 episode reward: [-0.00162882]
All agents episode reward: [-0.00162882]
Agent gate_2 episode reward: [-0.00709876]
All agents episode reward: [-0.00709876]
Agent gate_2 episode reward: [-0.00836894]
All agents episode reward: [-0.00836894]
Agent gate_2 episode reward: [-0.00309563]
All agents episode reward: [-0.00309563]
Iteration 2: 100%|██████████| 5/5 [00:11<00:00,  2.28s/it]
Agent gate_2 episode reward: [-0.00743362]
All agents episode reward: [-0.00743362]
Agent gate_2 episode reward: [-0.01207767]
All agents episode reward: [-0.01207767]
Agent gate_2 episode reward: [-0.0041204]
All agents episode reward: [-0.0041204]
Agent gate_2 episode reward: [-0.00460376]
All agents episode reward: [-0.00460376]
Agent gate_2 episode reward: [-0.01228428]
All agents episode reward: [-0.01228428]
Iteration 3: 100%|██████████| 5/5 [00:11<00:00,  2.24s/it]
Agent gate_2 episode reward: [-0.00500161]
All agents episode reward: [-0.00500161]
Agent gate_2 episode reward: [-0.00594862]
All agents episode reward: [-0.00594862]
Agent gate_2 episode reward: [0.]
All agents episode reward: [0.]
Agent gate_2 episode reward: [-0.01257976]
All agents episode reward: [-0.01257976]
Agent gate_2 episode reward: [-0.00452986]
All agents episode reward: [-0.00452986]
Iteration 4: 100%|██████████| 5/5 [00:11<00:00,  2.27s/it]
Agent gate_2 episode reward: [-0.01374653]
All agents episode reward: [-0.01374653]
Agent gate_2 episode reward: [-0.00548275]
All agents episode reward: [-0.00548275]
Agent gate_2 episode reward: [-0.00397716]
All agents episode reward: [-0.00397716]
Agent gate_2 episode reward: [-0.01107865]
All agents episode reward: [-0.01107865]
Agent gate_2 episode reward: [-0.00377089]
All agents episode reward: [-0.00377089]
Iteration 5: 100%|██████████| 5/5 [00:15<00:00,  3.10s/it]
Agent gate_2 episode reward: [-0.00926453]
All agents episode reward: [-0.00926453]
Agent gate_2 episode reward: [-0.01950992]
All agents episode reward: [-0.01950992]
Agent gate_2 episode reward: [-0.01304686]
All agents episode reward: [-0.01304686]
Agent gate_2 episode reward: [-0.00542345]
All agents episode reward: [-0.00542345]
Saved 1 agents to ppo_agents_butterfly_scC
[Validation] New best avg return: -272797.188 at episode 30 (over 5 val episodes, saved to ppo_agents_butterfly_scC)
Agent gate_2 episode reward: [-0.006035]
All agents episode reward: [-0.006035]
Iteration 6: 100%|██████████| 5/5 [00:12<00:00,  2.51s/it]
Agent gate_2 episode reward: [-0.00511509]
All agents episode reward: [-0.00511509]
Agent gate_2 episode reward: [-0.0187846]
All agents episode reward: [-0.0187846]
Agent gate_2 episode reward: [-0.00762434]
All agents episode reward: [-0.00762434]
Agent gate_2 episode reward: [-0.0308661]
All agents episode reward: [-0.0308661]
Agent gate_2 episode reward: [-0.01463969]
All agents episode reward: [-0.01463969]
Iteration 7: 100%|██████████| 5/5 [00:15<00:00,  3.04s/it]
Agent gate_2 episode reward: [-0.00833491]
All agents episode reward: [-0.00833491]
Agent gate_2 episode reward: [-0.01352702]
All agents episode reward: [-0.01352702]
Agent gate_2 episode reward: [-0.00916319]
All agents episode reward: [-0.00916319]
Agent gate_2 episode reward: [0.]
All agents episode reward: [0.]
Agent gate_2 episode reward: [-0.00803119]
All agents episode reward: [-0.00803119]
Iteration 8: 100%|██████████| 5/5 [00:12<00:00,  2.45s/it]
Agent gate_2 episode reward: [-0.00893276]
All agents episode reward: [-0.00893276]
Agent gate_2 episode reward: [-0.01403537]
All agents episode reward: [-0.01403537]
Agent gate_2 episode reward: [-0.0159233]
All agents episode reward: [-0.0159233]
Agent gate_2 episode reward: [-0.01209413]
All agents episode reward: [-0.01209413]
Agent gate_2 episode reward: [-0.02082075]
All agents episode reward: [-0.02082075]
Iteration 9: 100%|██████████| 5/5 [00:18<00:00,  3.63s/it]
Agent gate_2 episode reward: [-0.01773425]
All agents episode reward: [-0.01773425]
Agent gate_2 episode reward: [-0.00951464]
All agents episode reward: [-0.00951464]
Agent gate_2 episode reward: [-0.01055929]
All agents episode reward: [-0.01055929]
Agent gate_2 episode reward: [-0.02169788]
All agents episode reward: [-0.02169788]
Agent gate_2 episode reward: [-0.00897902]
All agents episode reward: [-0.00897902]
Loaded 1 agents from ppo_agents_butterfly_scC
Running 10 evaluation runs...
  Run 1/10... Avg agent reward (episode): -168852.641 | Total reward: -168852.641
Saved run 1 to rl_training/butterfly_scC/ppo_run1
  Run 2/10... Avg agent reward (episode): -430968.125 | Total reward: -430968.125
Saved run 2 to rl_training/butterfly_scC/ppo_run2
  Run 3/10... Avg agent reward (episode): -261456.281 | Total reward: -261456.281
Saved run 3 to rl_training/butterfly_scC/ppo_run3
  Run 4/10... Avg agent reward (episode): -705950.812 | Total reward: -705950.812
Saved run 4 to rl_training/butterfly_scC/ppo_run4
  Run 5/10... Avg agent reward (episode): -488222.125 | Total reward: -488222.125
Saved run 5 to rl_training/butterfly_scC/ppo_run5
  Run 6/10... Avg agent reward (episode): -366496.125 | Total reward: -366496.125
Saved run 6 to rl_training/butterfly_scC/ppo_run6
  Run 7/10... Avg agent reward (episode): -385857.688 | Total reward: -385857.688
Saved run 7 to rl_training/butterfly_scC/ppo_run7
  Run 8/10... Avg agent reward (episode): -257767.312 | Total reward: -257767.312
Saved run 8 to rl_training/butterfly_scC/ppo_run8
  Run 9/10... Avg agent reward (episode): -676446.500 | Total reward: -676446.500
Saved run 9 to rl_training/butterfly_scC/ppo_run9
  Run 10/10... Avg agent reward (episode): -177865.828 | Total reward: -177865.828
Saved run 10 to rl_training/butterfly_scC/ppo_run10
============================================================
Evaluation Results
  Number of runs: 10
============================================================
  Agent gate_2: -391988.312 ± 179345.625
  Average reward: -391988.312 ± 179345.625
  Total reward: -391988.312 ± 179345.625
============================================================
Running 10 evaluation runs...
  Run 1/10... Avg agent reward (episode): -169535.297 | Total reward: -169535.297
Saved run 1 to rl_training/butterfly_scC/rule_based_run1
  Run 2/10... Avg agent reward (episode): -430968.125 | Total reward: -430968.125
Saved run 2 to rl_training/butterfly_scC/rule_based_run2
  Run 3/10... Avg agent reward (episode): -261456.281 | Total reward: -261456.281
Saved run 3 to rl_training/butterfly_scC/rule_based_run3
  Run 4/10... Avg agent reward (episode): -705950.812 | Total reward: -705950.812
Saved run 4 to rl_training/butterfly_scC/rule_based_run4
  Run 5/10... Avg agent reward (episode): -488222.125 | Total reward: -488222.125
Saved run 5 to rl_training/butterfly_scC/rule_based_run5
  Run 6/10... Avg agent reward (episode): -366496.125 | Total reward: -366496.125
Saved run 6 to rl_training/butterfly_scC/rule_based_run6
  Run 7/10... Avg agent reward (episode): -385857.688 | Total reward: -385857.688
Saved run 7 to rl_training/butterfly_scC/rule_based_run7
  Run 8/10... Avg agent reward (episode): -257767.312 | Total reward: -257767.312
Saved run 8 to rl_training/butterfly_scC/rule_based_run8
  Run 9/10... Avg agent reward (episode): -676446.500 | Total reward: -676446.500
Saved run 9 to rl_training/butterfly_scC/rule_based_run9
  Run 10/10... Avg agent reward (episode): -177865.828 | Total reward: -177865.828
Saved run 10 to rl_training/butterfly_scC/rule_based_run10
============================================================
Evaluation Results
  Number of runs: 10
============================================================
  Agent gate_2: -392056.594 ± 179260.812
  Average reward: -392056.594 ± 179260.812
  Total reward: -392056.594 ± 179260.812
============================================================
Running 10 evaluation runs...
  Run 1/10... No actions provided, skipping action application.
Avg agent reward (episode): -169535.297 | Total reward: -169535.297
Saved run 1 to rl_training/butterfly_scC/no_control_run1
  Run 2/10... No actions provided, skipping action application.
Avg agent reward (episode): -430968.125 | Total reward: -430968.125
Saved run 2 to rl_training/butterfly_scC/no_control_run2
  Run 3/10... No actions provided, skipping action application.
Avg agent reward (episode): -261456.281 | Total reward: -261456.281
Saved run 3 to rl_training/butterfly_scC/no_control_run3
  Run 4/10... No actions provided, skipping action application.
Avg agent reward (episode): -705950.812 | Total reward: -705950.812
Saved run 4 to rl_training/butterfly_scC/no_control_run4
  Run 5/10... No actions provided, skipping action application.
Avg agent reward (episode): -488222.125 | Total reward: -488222.125
Saved run 5 to rl_training/butterfly_scC/no_control_run5
  Run 6/10... No actions provided, skipping action application.
Avg agent reward (episode): -366496.125 | Total reward: -366496.125
Saved run 6 to rl_training/butterfly_scC/no_control_run6
  Run 7/10... No actions provided, skipping action application.
Avg agent reward (episode): -385857.688 | Total reward: -385857.688
Saved run 7 to rl_training/butterfly_scC/no_control_run7
  Run 8/10... No actions provided, skipping action application.
Avg agent reward (episode): -257767.312 | Total reward: -257767.312
Saved run 8 to rl_training/butterfly_scC/no_control_run8
  Run 9/10... No actions provided, skipping action application.
Avg agent reward (episode): -676446.500 | Total reward: -676446.500
Saved run 9 to rl_training/butterfly_scC/no_control_run9
  Run 10/10... No actions provided, skipping action application.
Avg agent reward (episode): -177865.828 | Total reward: -177865.828
Saved run 10 to rl_training/butterfly_scC/no_control_run10
============================================================
Evaluation Results
  Number of runs: 10
============================================================
  Agent gate_2: -392056.594 ± 179260.812
  Average reward: -392056.594 ± 179260.812
  Total reward: -392056.594 ± 179260.812
============================================================

============================================================
Comparison of All Methods
============================================================
ppo avg reward:        -391988.312
Rule-based avg reward: -392056.594
No control avg reward: -392056.594
============================================================
/Users/mmai/anaconda3/envs/control/lib/python3.11/site-packages/matplotlib/patches.py:3421: RuntimeWarning: invalid value encountered in scalar divide
  cos_t, sin_t = head_length / head_dist, head_width / head_dist
