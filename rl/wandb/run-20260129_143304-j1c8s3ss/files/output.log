Iteration 0: 100%|██████████| 5/5 [00:09<00:00,  1.95s/it]
Agent gate_2 episode reward: [-78.59825278]
All agents episode reward: [-78.59825278]
Agent gate_2 episode reward: [-14.24232693]
All agents episode reward: [-14.24232693]
Agent gate_2 episode reward: [-5.3402884]
All agents episode reward: [-5.3402884]
Agent gate_2 episode reward: [-6.45969526]
All agents episode reward: [-6.45969526]
Agent gate_2 episode reward: [-7.02745343]
All agents episode reward: [-7.02745343]
Iteration 1: 100%|██████████| 5/5 [00:09<00:00,  1.90s/it]
Agent gate_2 episode reward: [-4.27936903]
All agents episode reward: [-4.27936903]
Agent gate_2 episode reward: [-42.16048727]
All agents episode reward: [-42.16048727]
Agent gate_2 episode reward: [-0.12391739]
All agents episode reward: [-0.12391739]
Agent gate_2 episode reward: [-0.08076526]
All agents episode reward: [-0.08076526]
Agent gate_2 episode reward: [-0.036441]
All agents episode reward: [-0.036441]
Iteration 2: 100%|██████████| 5/5 [00:09<00:00,  1.94s/it]
Agent gate_2 episode reward: [-0.02173515]
All agents episode reward: [-0.02173515]
Agent gate_2 episode reward: [-0.02411865]
All agents episode reward: [-0.02411865]
Agent gate_2 episode reward: [-0.02065963]
All agents episode reward: [-0.02065963]
Agent gate_2 episode reward: [-0.01809003]
All agents episode reward: [-0.01809003]
Agent gate_2 episode reward: [-0.01073899]
All agents episode reward: [-0.01073899]
Iteration 3: 100%|██████████| 5/5 [00:09<00:00,  1.94s/it]
Agent gate_2 episode reward: [-0.01256044]
All agents episode reward: [-0.01256044]
Agent gate_2 episode reward: [-0.01581795]
All agents episode reward: [-0.01581795]
Agent gate_2 episode reward: [-0.01962198]
All agents episode reward: [-0.01962198]
Agent gate_2 episode reward: [-0.0317988]
All agents episode reward: [-0.0317988]
Agent gate_2 episode reward: [-6.92265287e-05]
All agents episode reward: [-6.92265287e-05]
Iteration 4: 100%|██████████| 5/5 [00:09<00:00,  1.90s/it]
Agent gate_2 episode reward: [-3.23344852e-05]
All agents episode reward: [-3.23344852e-05]
Agent gate_2 episode reward: [-0.03452064]
All agents episode reward: [-0.03452064]
Agent gate_2 episode reward: [-0.03110132]
All agents episode reward: [-0.03110132]
Agent gate_2 episode reward: [-0.02764177]
All agents episode reward: [-0.02764177]
Agent gate_2 episode reward: [-0.0393207]
All agents episode reward: [-0.0393207]
Iteration 5: 100%|██████████| 5/5 [00:13<00:00,  2.62s/it]
Agent gate_2 episode reward: [-0.03686168]
All agents episode reward: [-0.03686168]
Agent gate_2 episode reward: [-8.2136006e-06]
All agents episode reward: [-8.2136006e-06]
Agent gate_2 episode reward: [-0.01729009]
All agents episode reward: [-0.01729009]
Agent gate_2 episode reward: [-0.01443051]
All agents episode reward: [-0.01443051]
Saved 1 agents to ppo_agents_butterfly_scC
[Validation] New best avg return: -259079984.000 at episode 30 (over 5 val episodes, saved to ppo_agents_butterfly_scC)
Agent gate_2 episode reward: [-0.02096038]
All agents episode reward: [-0.02096038]
Iteration 6: 100%|██████████| 5/5 [00:13<00:00,  2.62s/it]
Agent gate_2 episode reward: [-0.0249792]
All agents episode reward: [-0.0249792]
Agent gate_2 episode reward: [-0.04295355]
All agents episode reward: [-0.04295355]
Agent gate_2 episode reward: [-0.03848751]
All agents episode reward: [-0.03848751]
Agent gate_2 episode reward: [-0.03826984]
All agents episode reward: [-0.03826984]
Agent gate_2 episode reward: [-0.04884275]
All agents episode reward: [-0.04884275]
Iteration 7: 100%|██████████| 5/5 [00:14<00:00,  2.90s/it]
Agent gate_2 episode reward: [-0.03836621]
All agents episode reward: [-0.03836621]
Agent gate_2 episode reward: [-0.01049151]
All agents episode reward: [-0.01049151]
Agent gate_2 episode reward: [-0.04105089]
All agents episode reward: [-0.04105089]
Agent gate_2 episode reward: [-0.0245833]
All agents episode reward: [-0.0245833]
Saved 1 agents to ppo_agents_butterfly_scC
[Validation] New best avg return: -194045824.000 at episode 40 (over 5 val episodes, saved to ppo_agents_butterfly_scC)
Agent gate_2 episode reward: [-0.05126349]
All agents episode reward: [-0.05126349]
Iteration 8: 100%|██████████| 5/5 [00:14<00:00,  2.91s/it]
Agent gate_2 episode reward: [0.]
All agents episode reward: [0.]
Agent gate_2 episode reward: [-0.06038393]
All agents episode reward: [-0.06038393]
Agent gate_2 episode reward: [-0.04721792]
All agents episode reward: [-0.04721792]
Agent gate_2 episode reward: [-0.02729214]
All agents episode reward: [-0.02729214]
Agent gate_2 episode reward: [-0.03944633]
All agents episode reward: [-0.03944633]
Iteration 9: 100%|██████████| 5/5 [00:13<00:00,  2.73s/it]
Agent gate_2 episode reward: [-0.03448883]
All agents episode reward: [-0.03448883]
Agent gate_2 episode reward: [-0.04190985]
All agents episode reward: [-0.04190985]
Agent gate_2 episode reward: [-0.02730717]
All agents episode reward: [-0.02730717]
Agent gate_2 episode reward: [-0.01945763]
All agents episode reward: [-0.01945763]
Agent gate_2 episode reward: [-0.02333926]
All agents episode reward: [-0.02333926]
Saved 1 agents to ppo_agents_butterfly_scC
Loaded 1 agents from ppo_agents_butterfly_scC
Running 10 evaluation runs...
  Run 1/10... Avg agent reward (episode): -212221648.000 | Total reward: -212221648.000
Saved run 1 to rl_training/butterfly_scC/ppo_run1
  Run 2/10... Avg agent reward (episode): -368373984.000 | Total reward: -368373984.000
Saved run 2 to rl_training/butterfly_scC/ppo_run2
  Run 3/10... Avg agent reward (episode): -424925152.000 | Total reward: -424925152.000
Saved run 3 to rl_training/butterfly_scC/ppo_run3
  Run 4/10... Avg agent reward (episode): -509145024.000 | Total reward: -509145024.000
Saved run 4 to rl_training/butterfly_scC/ppo_run4
  Run 5/10... Avg agent reward (episode): -340236480.000 | Total reward: -340236480.000
Saved run 5 to rl_training/butterfly_scC/ppo_run5
  Run 6/10... Avg agent reward (episode): -424583296.000 | Total reward: -424583296.000
Saved run 6 to rl_training/butterfly_scC/ppo_run6
  Run 7/10... Avg agent reward (episode): -454983584.000 | Total reward: -454983584.000
Saved run 7 to rl_training/butterfly_scC/ppo_run7
  Run 8/10... Avg agent reward (episode): -372451584.000 | Total reward: -372451584.000
Saved run 8 to rl_training/butterfly_scC/ppo_run8
  Run 9/10... Avg agent reward (episode): -388916768.000 | Total reward: -388916768.000
Saved run 9 to rl_training/butterfly_scC/ppo_run9
  Run 10/10... Avg agent reward (episode): -282964896.000 | Total reward: -282964896.000
Saved run 10 to rl_training/butterfly_scC/ppo_run10
============================================================
Evaluation Results
  Number of runs: 10
============================================================
  Agent gate_2: -377880256.000 ± 81043296.000
  Average reward: -377880256.000 ± 81043296.000
  Total reward: -377880256.000 ± 81043296.000
============================================================
Running 10 evaluation runs...
  Run 1/10... Avg agent reward (episode): -212221648.000 | Total reward: -212221648.000
Saved run 1 to rl_training/butterfly_scC/rule_based_run1
  Run 2/10... Avg agent reward (episode): -368373984.000 | Total reward: -368373984.000
Saved run 2 to rl_training/butterfly_scC/rule_based_run2
  Run 3/10... Avg agent reward (episode): -424925152.000 | Total reward: -424925152.000
Saved run 3 to rl_training/butterfly_scC/rule_based_run3
  Run 4/10... Avg agent reward (episode): -509145024.000 | Total reward: -509145024.000
Saved run 4 to rl_training/butterfly_scC/rule_based_run4
  Run 5/10... Avg agent reward (episode): -340236480.000 | Total reward: -340236480.000
Saved run 5 to rl_training/butterfly_scC/rule_based_run5
  Run 6/10... Avg agent reward (episode): -424583296.000 | Total reward: -424583296.000
Saved run 6 to rl_training/butterfly_scC/rule_based_run6
  Run 7/10... Avg agent reward (episode): -454983584.000 | Total reward: -454983584.000
Saved run 7 to rl_training/butterfly_scC/rule_based_run7
  Run 8/10... Avg agent reward (episode): -372451584.000 | Total reward: -372451584.000
Saved run 8 to rl_training/butterfly_scC/rule_based_run8
  Run 9/10... Avg agent reward (episode): -388916768.000 | Total reward: -388916768.000
Saved run 9 to rl_training/butterfly_scC/rule_based_run9
  Run 10/10... Avg agent reward (episode): -282964896.000 | Total reward: -282964896.000
Saved run 10 to rl_training/butterfly_scC/rule_based_run10
============================================================
Evaluation Results
  Number of runs: 10
============================================================
  Agent gate_2: -377880256.000 ± 81043296.000
  Average reward: -377880256.000 ± 81043296.000
  Total reward: -377880256.000 ± 81043296.000
============================================================
Running 10 evaluation runs...
  Run 1/10... No actions provided, skipping action application.
Avg agent reward (episode): -212221648.000 | Total reward: -212221648.000
Saved run 1 to rl_training/butterfly_scC/no_control_run1
  Run 2/10... No actions provided, skipping action application.
Avg agent reward (episode): -368373984.000 | Total reward: -368373984.000
Saved run 2 to rl_training/butterfly_scC/no_control_run2
  Run 3/10... No actions provided, skipping action application.
Avg agent reward (episode): -424925152.000 | Total reward: -424925152.000
Saved run 3 to rl_training/butterfly_scC/no_control_run3
  Run 4/10... No actions provided, skipping action application.
Avg agent reward (episode): -509145024.000 | Total reward: -509145024.000
Saved run 4 to rl_training/butterfly_scC/no_control_run4
  Run 5/10... No actions provided, skipping action application.
Avg agent reward (episode): -340236480.000 | Total reward: -340236480.000
Saved run 5 to rl_training/butterfly_scC/no_control_run5
  Run 6/10... No actions provided, skipping action application.
Avg agent reward (episode): -424583296.000 | Total reward: -424583296.000
Saved run 6 to rl_training/butterfly_scC/no_control_run6
  Run 7/10... No actions provided, skipping action application.
Avg agent reward (episode): -454983584.000 | Total reward: -454983584.000
Saved run 7 to rl_training/butterfly_scC/no_control_run7
  Run 8/10... No actions provided, skipping action application.
Avg agent reward (episode): -372451584.000 | Total reward: -372451584.000
Saved run 8 to rl_training/butterfly_scC/no_control_run8
  Run 9/10... No actions provided, skipping action application.
Avg agent reward (episode): -388916768.000 | Total reward: -388916768.000
Saved run 9 to rl_training/butterfly_scC/no_control_run9
  Run 10/10... No actions provided, skipping action application.
Avg agent reward (episode): -282964896.000 | Total reward: -282964896.000
Saved run 10 to rl_training/butterfly_scC/no_control_run10
============================================================
Evaluation Results
  Number of runs: 10
============================================================
  Agent gate_2: -377880256.000 ± 81043296.000
  Average reward: -377880256.000 ± 81043296.000
  Total reward: -377880256.000 ± 81043296.000
============================================================

============================================================
Comparison of All Methods
============================================================
ppo avg reward:        -377880256.000
Rule-based avg reward: -377880256.000
No control avg reward: -377880256.000
============================================================
/Users/mmai/anaconda3/envs/control/lib/python3.11/site-packages/matplotlib/patches.py:3421: RuntimeWarning: invalid value encountered in scalar divide
  cos_t, sin_t = head_length / head_dist, head_width / head_dist
