Iteration 0: 100%|██████████| 5/5 [00:11<00:00,  2.37s/it]
Agent gate_2 episode reward: [-84.21495833]
All agents episode reward: [-84.21495833]
Agent gate_2 episode reward: [-15.90251859]
All agents episode reward: [-15.90251859]
Agent gate_2 episode reward: [-4.92199047]
All agents episode reward: [-4.92199047]
Agent gate_2 episode reward: [-0.83397713]
All agents episode reward: [-0.83397713]
Agent gate_2 episode reward: [-1.32276232]
All agents episode reward: [-1.32276232]
Iteration 1: 100%|██████████| 5/5 [00:12<00:00,  2.42s/it]
Agent gate_2 episode reward: [-1.33591125]
All agents episode reward: [-1.33591125]
Agent gate_2 episode reward: [-1.2367254]
All agents episode reward: [-1.2367254]
Agent gate_2 episode reward: [-1.65609305]
All agents episode reward: [-1.65609305]
Agent gate_2 episode reward: [-0.6408655]
All agents episode reward: [-0.6408655]
Agent gate_2 episode reward: [-1.41409771]
All agents episode reward: [-1.41409771]
Iteration 2: 100%|██████████| 5/5 [00:11<00:00,  2.32s/it]
Agent gate_2 episode reward: [-1.47119015]
All agents episode reward: [-1.47119015]
Agent gate_2 episode reward: [-1.24591624]
All agents episode reward: [-1.24591624]
Agent gate_2 episode reward: [-0.08317553]
All agents episode reward: [-0.08317553]
Agent gate_2 episode reward: [-2.27586208]
All agents episode reward: [-2.27586208]
Agent gate_2 episode reward: [-2.19732671]
All agents episode reward: [-2.19732671]
Iteration 3: 100%|██████████| 5/5 [00:11<00:00,  2.35s/it]
Agent gate_2 episode reward: [-1.8404057]
All agents episode reward: [-1.8404057]
Agent gate_2 episode reward: [-1.79482422]
All agents episode reward: [-1.79482422]
Agent gate_2 episode reward: [-2.11571403]
All agents episode reward: [-2.11571403]
Agent gate_2 episode reward: [-0.71434711]
All agents episode reward: [-0.71434711]
Agent gate_2 episode reward: [-1.79524277]
All agents episode reward: [-1.79524277]
Iteration 4: 100%|██████████| 5/5 [00:11<00:00,  2.26s/it]
Agent gate_2 episode reward: [-1.9134733]
All agents episode reward: [-1.9134733]
Agent gate_2 episode reward: [0.]
All agents episode reward: [0.]
Agent gate_2 episode reward: [-2.01620877]
All agents episode reward: [-2.01620877]
Agent gate_2 episode reward: [-1.62283407]
All agents episode reward: [-1.62283407]
Agent gate_2 episode reward: [-1.90293555]
All agents episode reward: [-1.90293555]
Iteration 5: 100%|██████████| 5/5 [00:15<00:00,  3.07s/it]
Agent gate_2 episode reward: [-1.94980635]
All agents episode reward: [-1.94980635]
Agent gate_2 episode reward: [-1.78953944]
All agents episode reward: [-1.78953944]
Agent gate_2 episode reward: [-1.8947193]
All agents episode reward: [-1.8947193]
Agent gate_2 episode reward: [-2.15132062]
All agents episode reward: [-2.15132062]
Saved 1 agents to ppo_agents_butterfly_scC
[Validation] New best avg return: -282273024.000 at episode 30 (over 5 val episodes, saved to ppo_agents_butterfly_scC)
Agent gate_2 episode reward: [-3.3844285]
All agents episode reward: [-3.3844285]
Iteration 6: 100%|██████████| 5/5 [00:19<00:00,  3.87s/it]
Agent gate_2 episode reward: [-1.47873694]
All agents episode reward: [-1.47873694]
Agent gate_2 episode reward: [-2.78437131]
All agents episode reward: [-2.78437131]
Agent gate_2 episode reward: [-2.19064815]
All agents episode reward: [-2.19064815]
Agent gate_2 episode reward: [-1.37565557]
All agents episode reward: [-1.37565557]
Saved 1 agents to ppo_agents_butterfly_scC
[Validation] New best avg return: -221526832.000 at episode 35 (over 5 val episodes, saved to ppo_agents_butterfly_scC)
Agent gate_2 episode reward: [-2.56815503]
All agents episode reward: [-2.56815503]
Iteration 7: 100%|██████████| 5/5 [00:17<00:00,  3.54s/it]
Agent gate_2 episode reward: [-1.33963476]
All agents episode reward: [-1.33963476]
Agent gate_2 episode reward: [-3.12546264]
All agents episode reward: [-3.12546264]
Agent gate_2 episode reward: [0.]
All agents episode reward: [0.]
Agent gate_2 episode reward: [-3.10581622]
All agents episode reward: [-3.10581622]
Agent gate_2 episode reward: [-1.56275071]
All agents episode reward: [-1.56275071]
Iteration 8: 100%|██████████| 5/5 [00:18<00:00,  3.67s/it]
Agent gate_2 episode reward: [-3.3610235]
All agents episode reward: [-3.3610235]
Agent gate_2 episode reward: [-2.51528874]
All agents episode reward: [-2.51528874]
Agent gate_2 episode reward: [-2.96912056]
All agents episode reward: [-2.96912056]
Agent gate_2 episode reward: [-2.29148546]
All agents episode reward: [-2.29148546]
Agent gate_2 episode reward: [-2.69415938]
All agents episode reward: [-2.69415938]
Iteration 9: 100%|██████████| 5/5 [00:16<00:00,  3.29s/it]
Agent gate_2 episode reward: [-4.49039731]
All agents episode reward: [-4.49039731]
Agent gate_2 episode reward: [-3.92608787]
All agents episode reward: [-3.92608787]
Agent gate_2 episode reward: [-3.36854957]
All agents episode reward: [-3.36854957]
Agent gate_2 episode reward: [-1.42853133]
All agents episode reward: [-1.42853133]
Saved 1 agents to ppo_agents_butterfly_scC
[Validation] New best avg return: -182796016.000 at episode 50 (over 5 val episodes, saved to ppo_agents_butterfly_scC)
Agent gate_2 episode reward: [-4.88975966]
All agents episode reward: [-4.88975966]
Saved 1 agents to ppo_agents_butterfly_scC
Loaded 1 agents from ppo_agents_butterfly_scC
Running 10 evaluation runs...
  Run 1/10... Avg agent reward (episode): -212221648.000 | Total reward: -212221648.000
Saved run 1 to rl_training/butterfly_scC/ppo_run1
  Run 2/10... Avg agent reward (episode): -368373984.000 | Total reward: -368373984.000
Saved run 2 to rl_training/butterfly_scC/ppo_run2
  Run 3/10... Avg agent reward (episode): -424925152.000 | Total reward: -424925152.000
Saved run 3 to rl_training/butterfly_scC/ppo_run3
  Run 4/10... Avg agent reward (episode): -509145024.000 | Total reward: -509145024.000
Saved run 4 to rl_training/butterfly_scC/ppo_run4
  Run 5/10... Avg agent reward (episode): -340236480.000 | Total reward: -340236480.000
Saved run 5 to rl_training/butterfly_scC/ppo_run5
  Run 6/10... Avg agent reward (episode): -424583296.000 | Total reward: -424583296.000
Saved run 6 to rl_training/butterfly_scC/ppo_run6
  Run 7/10... Avg agent reward (episode): -454983584.000 | Total reward: -454983584.000
Saved run 7 to rl_training/butterfly_scC/ppo_run7
  Run 8/10... Avg agent reward (episode): -372451584.000 | Total reward: -372451584.000
Saved run 8 to rl_training/butterfly_scC/ppo_run8
  Run 9/10... Avg agent reward (episode): -388916768.000 | Total reward: -388916768.000
Saved run 9 to rl_training/butterfly_scC/ppo_run9
  Run 10/10... Avg agent reward (episode): -282964896.000 | Total reward: -282964896.000
Saved run 10 to rl_training/butterfly_scC/ppo_run10
============================================================
Evaluation Results
  Number of runs: 10
============================================================
  Agent gate_2: -377880256.000 ± 81043296.000
  Average reward: -377880256.000 ± 81043296.000
  Total reward: -377880256.000 ± 81043296.000
============================================================
Running 10 evaluation runs...
  Run 1/10... Avg agent reward (episode): -212221648.000 | Total reward: -212221648.000
Saved run 1 to rl_training/butterfly_scC/rule_based_run1
  Run 2/10... Avg agent reward (episode): -368373984.000 | Total reward: -368373984.000
Saved run 2 to rl_training/butterfly_scC/rule_based_run2
  Run 3/10... Avg agent reward (episode): -424925152.000 | Total reward: -424925152.000
Saved run 3 to rl_training/butterfly_scC/rule_based_run3
  Run 4/10... Avg agent reward (episode): -509145024.000 | Total reward: -509145024.000
Saved run 4 to rl_training/butterfly_scC/rule_based_run4
  Run 5/10... Avg agent reward (episode): -340236480.000 | Total reward: -340236480.000
Saved run 5 to rl_training/butterfly_scC/rule_based_run5
  Run 6/10... Avg agent reward (episode): -424583296.000 | Total reward: -424583296.000
Saved run 6 to rl_training/butterfly_scC/rule_based_run6
  Run 7/10... Avg agent reward (episode): -454983584.000 | Total reward: -454983584.000
Saved run 7 to rl_training/butterfly_scC/rule_based_run7
  Run 8/10... Avg agent reward (episode): -372451584.000 | Total reward: -372451584.000
Saved run 8 to rl_training/butterfly_scC/rule_based_run8
  Run 9/10... Avg agent reward (episode): -388916768.000 | Total reward: -388916768.000
Saved run 9 to rl_training/butterfly_scC/rule_based_run9
  Run 10/10... Avg agent reward (episode): -282964896.000 | Total reward: -282964896.000
Saved run 10 to rl_training/butterfly_scC/rule_based_run10
============================================================
Evaluation Results
  Number of runs: 10
============================================================
  Agent gate_2: -377880256.000 ± 81043296.000
  Average reward: -377880256.000 ± 81043296.000
  Total reward: -377880256.000 ± 81043296.000
============================================================
Running 10 evaluation runs...
  Run 1/10... No actions provided, skipping action application.
Avg agent reward (episode): -212221648.000 | Total reward: -212221648.000
Saved run 1 to rl_training/butterfly_scC/no_control_run1
  Run 2/10... No actions provided, skipping action application.
Avg agent reward (episode): -368373984.000 | Total reward: -368373984.000
Saved run 2 to rl_training/butterfly_scC/no_control_run2
  Run 3/10... No actions provided, skipping action application.
Avg agent reward (episode): -424925152.000 | Total reward: -424925152.000
Saved run 3 to rl_training/butterfly_scC/no_control_run3
  Run 4/10... No actions provided, skipping action application.
Avg agent reward (episode): -509145024.000 | Total reward: -509145024.000
Saved run 4 to rl_training/butterfly_scC/no_control_run4
  Run 5/10... No actions provided, skipping action application.
Avg agent reward (episode): -340236480.000 | Total reward: -340236480.000
Saved run 5 to rl_training/butterfly_scC/no_control_run5
  Run 6/10... No actions provided, skipping action application.
Avg agent reward (episode): -424583296.000 | Total reward: -424583296.000
Saved run 6 to rl_training/butterfly_scC/no_control_run6
  Run 7/10... No actions provided, skipping action application.
Avg agent reward (episode): -454983584.000 | Total reward: -454983584.000
Saved run 7 to rl_training/butterfly_scC/no_control_run7
  Run 8/10... No actions provided, skipping action application.
Avg agent reward (episode): -372451584.000 | Total reward: -372451584.000
Saved run 8 to rl_training/butterfly_scC/no_control_run8
  Run 9/10... No actions provided, skipping action application.
Avg agent reward (episode): -388916768.000 | Total reward: -388916768.000
Saved run 9 to rl_training/butterfly_scC/no_control_run9
  Run 10/10... No actions provided, skipping action application.
Avg agent reward (episode): -282964896.000 | Total reward: -282964896.000
Saved run 10 to rl_training/butterfly_scC/no_control_run10
============================================================
Evaluation Results
  Number of runs: 10
============================================================
  Agent gate_2: -377880256.000 ± 81043296.000
  Average reward: -377880256.000 ± 81043296.000
  Total reward: -377880256.000 ± 81043296.000
============================================================

============================================================
Comparison of All Methods
============================================================
ppo avg reward:        -377880256.000
Rule-based avg reward: -377880256.000
No control avg reward: -377880256.000
============================================================
/Users/mmai/anaconda3/envs/control/lib/python3.11/site-packages/matplotlib/patches.py:3421: RuntimeWarning: invalid value encountered in scalar divide
  cos_t, sin_t = head_length / head_dist, head_width / head_dist
