Iteration 0: 100%|██████████| 5/5 [00:11<00:00,  2.31s/it]
Agent gate_2 episode reward: [-95.90929519]
All agents episode reward: [-95.90929519]
Agent gate_2 episode reward: [-9.16511803]
All agents episode reward: [-9.16511803]
Agent gate_2 episode reward: [-4.86741571]
All agents episode reward: [-4.86741571]
Agent gate_2 episode reward: [-4.39827338]
All agents episode reward: [-4.39827338]
Agent gate_2 episode reward: [-3.97298563]
All agents episode reward: [-3.97298563]
Iteration 1: 100%|██████████| 5/5 [00:11<00:00,  2.27s/it]
Agent gate_2 episode reward: [-3.52313159]
All agents episode reward: [-3.52313159]
Agent gate_2 episode reward: [-2.96130523]
All agents episode reward: [-2.96130523]
Agent gate_2 episode reward: [-3.84287345]
All agents episode reward: [-3.84287345]
Agent gate_2 episode reward: [-3.19691926]
All agents episode reward: [-3.19691926]
Agent gate_2 episode reward: [0.]
All agents episode reward: [0.]
Iteration 2: 100%|██████████| 5/5 [00:11<00:00,  2.37s/it]
Agent gate_2 episode reward: [0.]
All agents episode reward: [0.]
Agent gate_2 episode reward: [-1.17587798]
All agents episode reward: [-1.17587798]
Agent gate_2 episode reward: [-0.57334971]
All agents episode reward: [-0.57334971]
Agent gate_2 episode reward: [-4.81531546]
All agents episode reward: [-4.81531546]
Agent gate_2 episode reward: [-0.83337744]
All agents episode reward: [-0.83337744]
Iteration 3: 100%|██████████| 5/5 [00:11<00:00,  2.29s/it]
Agent gate_2 episode reward: [-1.15963213]
All agents episode reward: [-1.15963213]
Agent gate_2 episode reward: [-6.11549292]
All agents episode reward: [-6.11549292]
Agent gate_2 episode reward: [-1.84224244]
All agents episode reward: [-1.84224244]
Agent gate_2 episode reward: [-4.80391886]
All agents episode reward: [-4.80391886]
Agent gate_2 episode reward: [-4.25715569]
All agents episode reward: [-4.25715569]
Iteration 4: 100%|██████████| 5/5 [00:11<00:00,  2.27s/it]
Agent gate_2 episode reward: [-4.41927109]
All agents episode reward: [-4.41927109]
Agent gate_2 episode reward: [-4.63168239]
All agents episode reward: [-4.63168239]
Agent gate_2 episode reward: [-5.0872514]
All agents episode reward: [-5.0872514]
Agent gate_2 episode reward: [-5.66419664]
All agents episode reward: [-5.66419664]
Agent gate_2 episode reward: [-5.53424391e-05]
All agents episode reward: [-5.53424391e-05]
Iteration 5: 100%|██████████| 5/5 [00:14<00:00,  2.99s/it]
Agent gate_2 episode reward: [-1.78083587e-05]
All agents episode reward: [-1.78083587e-05]
Agent gate_2 episode reward: [-4.33761952]
All agents episode reward: [-4.33761952]
Agent gate_2 episode reward: [-6.16131559]
All agents episode reward: [-6.16131559]
Agent gate_2 episode reward: [-6.49529672]
All agents episode reward: [-6.49529672]
Saved 1 agents to ppo_agents_butterfly_scC
[Validation] New best avg return: -245274592.000 at episode 30 (over 5 val episodes, saved to ppo_agents_butterfly_scC)
Agent gate_2 episode reward: [-3.06079928]
All agents episode reward: [-3.06079928]
Iteration 6: 100%|██████████| 5/5 [00:15<00:00,  3.05s/it]
Agent gate_2 episode reward: [-2.52902466]
All agents episode reward: [-2.52902466]
Agent gate_2 episode reward: [-7.12073024]
All agents episode reward: [-7.12073024]
Agent gate_2 episode reward: [-5.51242449]
All agents episode reward: [-5.51242449]
Agent gate_2 episode reward: [-7.33457716]
All agents episode reward: [-7.33457716]
Agent gate_2 episode reward: [-4.81272199]
All agents episode reward: [-4.81272199]
Iteration 7: 100%|██████████| 5/5 [00:15<00:00,  3.06s/it]
Agent gate_2 episode reward: [-4.73530534]
All agents episode reward: [-4.73530534]
Agent gate_2 episode reward: [-6.76639978]
All agents episode reward: [-6.76639978]
Agent gate_2 episode reward: [-8.72650195]
All agents episode reward: [-8.72650195]
Agent gate_2 episode reward: [-9.71897449]
All agents episode reward: [-9.71897449]
Agent gate_2 episode reward: [0.]
All agents episode reward: [0.]
Iteration 8: 100%|██████████| 5/5 [00:17<00:00,  3.46s/it]
Agent gate_2 episode reward: [-7.9200786]
All agents episode reward: [-7.9200786]
Agent gate_2 episode reward: [-5.35185165]
All agents episode reward: [-5.35185165]
Agent gate_2 episode reward: [-9.23840114]
All agents episode reward: [-9.23840114]
Agent gate_2 episode reward: [-9.71531813]
All agents episode reward: [-9.71531813]
Agent gate_2 episode reward: [-7.61202443]
All agents episode reward: [-7.61202443]
Iteration 9: 100%|██████████| 5/5 [00:14<00:00,  2.98s/it]
Agent gate_2 episode reward: [-7.56472831]
All agents episode reward: [-7.56472831]
Agent gate_2 episode reward: [-7.7291698]
All agents episode reward: [-7.7291698]
Agent gate_2 episode reward: [-5.35180209]
All agents episode reward: [-5.35180209]
Agent gate_2 episode reward: [-7.8914548]
All agents episode reward: [-7.8914548]
Agent gate_2 episode reward: [0.]
All agents episode reward: [0.]
Loaded 1 agents from ppo_agents_butterfly_scC
Running 10 evaluation runs...
  Run 1/10... Avg agent reward (episode): -212221648.000 | Total reward: -212221648.000
Saved run 1 to rl_training/butterfly_scC/ppo_run1
  Run 2/10... Avg agent reward (episode): -368373984.000 | Total reward: -368373984.000
Saved run 2 to rl_training/butterfly_scC/ppo_run2
  Run 3/10... Avg agent reward (episode): -424925152.000 | Total reward: -424925152.000
Saved run 3 to rl_training/butterfly_scC/ppo_run3
  Run 4/10... Avg agent reward (episode): -509145024.000 | Total reward: -509145024.000
Saved run 4 to rl_training/butterfly_scC/ppo_run4
  Run 5/10... Avg agent reward (episode): -340236480.000 | Total reward: -340236480.000
Saved run 5 to rl_training/butterfly_scC/ppo_run5
  Run 6/10... Avg agent reward (episode): -424583296.000 | Total reward: -424583296.000
Saved run 6 to rl_training/butterfly_scC/ppo_run6
  Run 7/10... Avg agent reward (episode): -454983584.000 | Total reward: -454983584.000
Saved run 7 to rl_training/butterfly_scC/ppo_run7
  Run 8/10... Avg agent reward (episode): -372451584.000 | Total reward: -372451584.000
Saved run 8 to rl_training/butterfly_scC/ppo_run8
  Run 9/10... Avg agent reward (episode): -388916768.000 | Total reward: -388916768.000
Saved run 9 to rl_training/butterfly_scC/ppo_run9
  Run 10/10... Avg agent reward (episode): -282964896.000 | Total reward: -282964896.000
Saved run 10 to rl_training/butterfly_scC/ppo_run10
============================================================
Evaluation Results
  Number of runs: 10
============================================================
  Agent gate_2: -377880256.000 ± 81043296.000
  Average reward: -377880256.000 ± 81043296.000
  Total reward: -377880256.000 ± 81043296.000
============================================================
Running 10 evaluation runs...
  Run 1/10... Avg agent reward (episode): -212221648.000 | Total reward: -212221648.000
Saved run 1 to rl_training/butterfly_scC/rule_based_run1
  Run 2/10... Avg agent reward (episode): -368373984.000 | Total reward: -368373984.000
Saved run 2 to rl_training/butterfly_scC/rule_based_run2
  Run 3/10... Avg agent reward (episode): -424925152.000 | Total reward: -424925152.000
Saved run 3 to rl_training/butterfly_scC/rule_based_run3
  Run 4/10... Avg agent reward (episode): -509145024.000 | Total reward: -509145024.000
Saved run 4 to rl_training/butterfly_scC/rule_based_run4
  Run 5/10... Avg agent reward (episode): -340236480.000 | Total reward: -340236480.000
Saved run 5 to rl_training/butterfly_scC/rule_based_run5
  Run 6/10... Avg agent reward (episode): -424583296.000 | Total reward: -424583296.000
Saved run 6 to rl_training/butterfly_scC/rule_based_run6
  Run 7/10... Avg agent reward (episode): -454983584.000 | Total reward: -454983584.000
Saved run 7 to rl_training/butterfly_scC/rule_based_run7
  Run 8/10... Avg agent reward (episode): -372451584.000 | Total reward: -372451584.000
Saved run 8 to rl_training/butterfly_scC/rule_based_run8
  Run 9/10... Avg agent reward (episode): -388916768.000 | Total reward: -388916768.000
Saved run 9 to rl_training/butterfly_scC/rule_based_run9
  Run 10/10... Avg agent reward (episode): -282964896.000 | Total reward: -282964896.000
Saved run 10 to rl_training/butterfly_scC/rule_based_run10
============================================================
Evaluation Results
  Number of runs: 10
============================================================
  Agent gate_2: -377880256.000 ± 81043296.000
  Average reward: -377880256.000 ± 81043296.000
  Total reward: -377880256.000 ± 81043296.000
============================================================
Running 10 evaluation runs...
  Run 1/10... No actions provided, skipping action application.
Avg agent reward (episode): -212221648.000 | Total reward: -212221648.000
Saved run 1 to rl_training/butterfly_scC/no_control_run1
  Run 2/10... No actions provided, skipping action application.
Avg agent reward (episode): -368373984.000 | Total reward: -368373984.000
Saved run 2 to rl_training/butterfly_scC/no_control_run2
  Run 3/10... No actions provided, skipping action application.
Avg agent reward (episode): -424925152.000 | Total reward: -424925152.000
Saved run 3 to rl_training/butterfly_scC/no_control_run3
  Run 4/10... No actions provided, skipping action application.
Avg agent reward (episode): -509145024.000 | Total reward: -509145024.000
Saved run 4 to rl_training/butterfly_scC/no_control_run4
  Run 5/10... No actions provided, skipping action application.
Avg agent reward (episode): -340236480.000 | Total reward: -340236480.000
Saved run 5 to rl_training/butterfly_scC/no_control_run5
  Run 6/10... No actions provided, skipping action application.
Avg agent reward (episode): -424583296.000 | Total reward: -424583296.000
Saved run 6 to rl_training/butterfly_scC/no_control_run6
  Run 7/10... No actions provided, skipping action application.
Avg agent reward (episode): -454983584.000 | Total reward: -454983584.000
Saved run 7 to rl_training/butterfly_scC/no_control_run7
  Run 8/10... No actions provided, skipping action application.
Avg agent reward (episode): -372451584.000 | Total reward: -372451584.000
Saved run 8 to rl_training/butterfly_scC/no_control_run8
  Run 9/10... No actions provided, skipping action application.
Avg agent reward (episode): -388916768.000 | Total reward: -388916768.000
Saved run 9 to rl_training/butterfly_scC/no_control_run9
  Run 10/10... No actions provided, skipping action application.
Avg agent reward (episode): -282964896.000 | Total reward: -282964896.000
Saved run 10 to rl_training/butterfly_scC/no_control_run10
============================================================
Evaluation Results
  Number of runs: 10
============================================================
  Agent gate_2: -377880256.000 ± 81043296.000
  Average reward: -377880256.000 ± 81043296.000
  Total reward: -377880256.000 ± 81043296.000
============================================================

============================================================
Comparison of All Methods
============================================================
ppo avg reward:        -377880256.000
Rule-based avg reward: -377880256.000
No control avg reward: -377880256.000
============================================================
/Users/mmai/anaconda3/envs/control/lib/python3.11/site-packages/matplotlib/patches.py:3421: RuntimeWarning: invalid value encountered in scalar divide
  cos_t, sin_t = head_length / head_dist, head_width / head_dist
