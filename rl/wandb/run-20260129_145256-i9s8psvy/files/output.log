Iteration 0: 100%|██████████| 5/5 [00:11<00:00,  2.34s/it]
Agent gate_2 episode reward: [27.2686132]
All agents episode reward: [27.2686132]
Agent gate_2 episode reward: [2.37853285]
All agents episode reward: [2.37853285]
Agent gate_2 episode reward: [2.70590944]
All agents episode reward: [2.70590944]
Agent gate_2 episode reward: [4.10347539]
All agents episode reward: [4.10347539]
Agent gate_2 episode reward: [4.61513195]
All agents episode reward: [4.61513195]
Iteration 1: 100%|██████████| 5/5 [00:13<00:00,  2.71s/it]
Agent gate_2 episode reward: [5.84118694]
All agents episode reward: [5.84118694]
Agent gate_2 episode reward: [4.41264618]
All agents episode reward: [4.41264618]
Agent gate_2 episode reward: [5.94201433]
All agents episode reward: [5.94201433]
Agent gate_2 episode reward: [5.49444372]
All agents episode reward: [5.49444372]
Agent gate_2 episode reward: [6.61919311]
All agents episode reward: [6.61919311]
Iteration 2: 100%|██████████| 5/5 [00:16<00:00,  3.26s/it]
Agent gate_2 episode reward: [7.26689659]
All agents episode reward: [7.26689659]
Agent gate_2 episode reward: [5.92266118]
All agents episode reward: [5.92266118]
Agent gate_2 episode reward: [5.68695846]
All agents episode reward: [5.68695846]
Agent gate_2 episode reward: [4.35653078]
All agents episode reward: [4.35653078]
Agent gate_2 episode reward: [4.69025855]
All agents episode reward: [4.69025855]
Iteration 3: 100%|██████████| 5/5 [00:12<00:00,  2.52s/it]
Agent gate_2 episode reward: [6.09202921]
All agents episode reward: [6.09202921]
Agent gate_2 episode reward: [7.34332499]
All agents episode reward: [7.34332499]
Agent gate_2 episode reward: [8.11568506]
All agents episode reward: [8.11568506]
Agent gate_2 episode reward: [8.92383659]
All agents episode reward: [8.92383659]
Agent gate_2 episode reward: [9.42535216]
All agents episode reward: [9.42535216]
Iteration 4: 100%|██████████| 5/5 [00:11<00:00,  2.33s/it]
Agent gate_2 episode reward: [11.26072097]
All agents episode reward: [11.26072097]
Agent gate_2 episode reward: [9.98010745]
All agents episode reward: [9.98010745]
Agent gate_2 episode reward: [10.17848172]
All agents episode reward: [10.17848172]
Agent gate_2 episode reward: [11.9053685]
All agents episode reward: [11.9053685]
Agent gate_2 episode reward: [11.97095448]
All agents episode reward: [11.97095448]
Iteration 5: 100%|██████████| 5/5 [00:15<00:00,  3.13s/it]
Agent gate_2 episode reward: [10.49957727]
All agents episode reward: [10.49957727]
Agent gate_2 episode reward: [7.73752525]
All agents episode reward: [7.73752525]
Agent gate_2 episode reward: [11.61184732]
All agents episode reward: [11.61184732]
Agent gate_2 episode reward: [9.15202821]
All agents episode reward: [9.15202821]
Saved 1 agents to ppo_agents_butterfly_scC
[Validation] New best avg return: 18855.689 at episode 30 (over 5 val episodes, saved to ppo_agents_butterfly_scC)
Agent gate_2 episode reward: [10.40195117]
All agents episode reward: [10.40195117]
Iteration 6: 100%|██████████| 5/5 [00:17<00:00,  3.50s/it]
Agent gate_2 episode reward: [19.89206475]
All agents episode reward: [19.89206475]
Agent gate_2 episode reward: [10.00076123]
All agents episode reward: [10.00076123]
Agent gate_2 episode reward: [10.03750462]
All agents episode reward: [10.03750462]
Agent gate_2 episode reward: [7.79697023]
All agents episode reward: [7.79697023]
Saved 1 agents to ppo_agents_butterfly_scC
[Validation] New best avg return: 24704.822 at episode 35 (over 5 val episodes, saved to ppo_agents_butterfly_scC)
Agent gate_2 episode reward: [8.08950479]
All agents episode reward: [8.08950479]
Iteration 7: 100%|██████████| 5/5 [00:15<00:00,  3.12s/it]
Agent gate_2 episode reward: [8.32158236]
All agents episode reward: [8.32158236]
Agent gate_2 episode reward: [8.81763535]
All agents episode reward: [8.81763535]
Agent gate_2 episode reward: [9.10622015]
All agents episode reward: [9.10622015]
Agent gate_2 episode reward: [10.1246226]
All agents episode reward: [10.1246226]
Saved 1 agents to ppo_agents_butterfly_scC
[Validation] New best avg return: 24790.889 at episode 40 (over 5 val episodes, saved to ppo_agents_butterfly_scC)
Agent gate_2 episode reward: [10.43812915]
All agents episode reward: [10.43812915]
Iteration 8: 100%|██████████| 5/5 [00:19<00:00,  3.85s/it]
Agent gate_2 episode reward: [10.4886826]
All agents episode reward: [10.4886826]
Agent gate_2 episode reward: [10.11559894]
All agents episode reward: [10.11559894]
Agent gate_2 episode reward: [9.45218746]
All agents episode reward: [9.45218746]
Agent gate_2 episode reward: [9.0378828]
All agents episode reward: [9.0378828]
Saved 1 agents to ppo_agents_butterfly_scC
[Validation] New best avg return: 25122.277 at episode 45 (over 5 val episodes, saved to ppo_agents_butterfly_scC)
Agent gate_2 episode reward: [9.65837601]
All agents episode reward: [9.65837601]
Iteration 9: 100%|██████████| 5/5 [00:16<00:00,  3.34s/it]
Agent gate_2 episode reward: [9.96407729]
All agents episode reward: [9.96407729]
Agent gate_2 episode reward: [9.25190518]
All agents episode reward: [9.25190518]
Agent gate_2 episode reward: [8.69996184]
All agents episode reward: [8.69996184]
Agent gate_2 episode reward: [8.22104843]
All agents episode reward: [8.22104843]
Agent gate_2 episode reward: [8.11882699]
All agents episode reward: [8.11882699]
Loaded 1 agents from ppo_agents_butterfly_scC
Running 10 evaluation runs...
  Run 1/10... Avg agent reward (episode): 24369.299 | Total reward: 24369.299
Saved run 1 to rl_training/butterfly_scC/ppo_run1
  Run 2/10... Avg agent reward (episode): 25584.074 | Total reward: 25584.074
Saved run 2 to rl_training/butterfly_scC/ppo_run2
  Run 3/10... Avg agent reward (episode): 25589.414 | Total reward: 25589.414
Saved run 3 to rl_training/butterfly_scC/ppo_run3
  Run 4/10... Avg agent reward (episode): 25624.600 | Total reward: 25624.600
Saved run 4 to rl_training/butterfly_scC/ppo_run4
  Run 5/10... Avg agent reward (episode): 25440.473 | Total reward: 25440.473
Saved run 5 to rl_training/butterfly_scC/ppo_run5
  Run 6/10... Avg agent reward (episode): 25580.959 | Total reward: 25580.959
Saved run 6 to rl_training/butterfly_scC/ppo_run6
  Run 7/10... Avg agent reward (episode): 25548.184 | Total reward: 25548.184
Saved run 7 to rl_training/butterfly_scC/ppo_run7
  Run 8/10... Avg agent reward (episode): 25552.170 | Total reward: 25552.170
Saved run 8 to rl_training/butterfly_scC/ppo_run8
  Run 9/10... Avg agent reward (episode): 25750.043 | Total reward: 25750.043
Saved run 9 to rl_training/butterfly_scC/ppo_run9
  Run 10/10... Avg agent reward (episode): 25120.572 | Total reward: 25120.572
Saved run 10 to rl_training/butterfly_scC/ppo_run10
============================================================
Evaluation Results
  Number of runs: 10
============================================================
  Agent gate_2: 25415.980 ± 382.113
  Average reward: 25415.980 ± 382.113
  Total reward: 25415.980 ± 382.113
============================================================
Running 10 evaluation runs...
  Run 1/10... Avg agent reward (episode): 3393.976 | Total reward: 3393.976
Saved run 1 to rl_training/butterfly_scC/rule_based_run1
  Run 2/10... Avg agent reward (episode): 4553.898 | Total reward: 4553.898
Saved run 2 to rl_training/butterfly_scC/rule_based_run2
  Run 3/10... Avg agent reward (episode): 4798.475 | Total reward: 4798.475
Saved run 3 to rl_training/butterfly_scC/rule_based_run3
  Run 4/10... Avg agent reward (episode): 5437.800 | Total reward: 5437.800
Saved run 4 to rl_training/butterfly_scC/rule_based_run4
  Run 5/10... Avg agent reward (episode): 4188.602 | Total reward: 4188.602
Saved run 5 to rl_training/butterfly_scC/rule_based_run5
  Run 6/10... Avg agent reward (episode): 4607.566 | Total reward: 4607.566
Saved run 6 to rl_training/butterfly_scC/rule_based_run6
  Run 7/10... Avg agent reward (episode): 5005.213 | Total reward: 5005.213
Saved run 7 to rl_training/butterfly_scC/rule_based_run7
  Run 8/10... Avg agent reward (episode): 4472.132 | Total reward: 4472.132
Saved run 8 to rl_training/butterfly_scC/rule_based_run8
  Run 9/10... Avg agent reward (episode): 4649.139 | Total reward: 4649.139
Saved run 9 to rl_training/butterfly_scC/rule_based_run9
  Run 10/10... Avg agent reward (episode): 4531.607 | Total reward: 4531.607
Saved run 10 to rl_training/butterfly_scC/rule_based_run10
============================================================
Evaluation Results
  Number of runs: 10
============================================================
  Agent gate_2: 4563.841 ± 504.162
  Average reward: 4563.841 ± 504.162
  Total reward: 4563.841 ± 504.162
============================================================
Running 10 evaluation runs...
  Run 1/10... No actions provided, skipping action application.
Avg agent reward (episode): -51.022 | Total reward: -51.022
Saved run 1 to rl_training/butterfly_scC/no_control_run1
  Run 2/10... No actions provided, skipping action application.
Avg agent reward (episode): -196.102 | Total reward: -196.102
Saved run 2 to rl_training/butterfly_scC/no_control_run2
  Run 3/10... No actions provided, skipping action application.
Avg agent reward (episode): -211.526 | Total reward: -211.526
Saved run 3 to rl_training/butterfly_scC/no_control_run3
  Run 4/10... No actions provided, skipping action application.
Avg agent reward (episode): -222.199 | Total reward: -222.199
Saved run 4 to rl_training/butterfly_scC/no_control_run4
  Run 5/10... No actions provided, skipping action application.
Avg agent reward (episode): -201.398 | Total reward: -201.398
Saved run 5 to rl_training/butterfly_scC/no_control_run5
  Run 6/10... No actions provided, skipping action application.
Avg agent reward (episode): -202.433 | Total reward: -202.433
Saved run 6 to rl_training/butterfly_scC/no_control_run6
  Run 7/10... No actions provided, skipping action application.
Avg agent reward (episode): -229.785 | Total reward: -229.785
Saved run 7 to rl_training/butterfly_scC/no_control_run7
  Run 8/10... No actions provided, skipping action application.
Avg agent reward (episode): -217.869 | Total reward: -217.869
Saved run 8 to rl_training/butterfly_scC/no_control_run8
  Run 9/10... No actions provided, skipping action application.
Avg agent reward (episode): -200.861 | Total reward: -200.861
Saved run 9 to rl_training/butterfly_scC/no_control_run9
  Run 10/10... No actions provided, skipping action application.
Avg agent reward (episode): -113.395 | Total reward: -113.395
Saved run 10 to rl_training/butterfly_scC/no_control_run10
============================================================
Evaluation Results
  Number of runs: 10
============================================================
  Agent gate_2: -184.659 ± 54.034
  Average reward: -184.659 ± 54.034
  Total reward: -184.659 ± 54.034
============================================================

============================================================
Comparison of All Methods
============================================================
ppo avg reward:        25415.980
Rule-based avg reward: 4563.841
No control avg reward: -184.659
============================================================
/Users/mmai/anaconda3/envs/control/lib/python3.11/site-packages/matplotlib/patches.py:3421: RuntimeWarning: invalid value encountered in scalar divide
  cos_t, sin_t = head_length / head_dist, head_width / head_dist
