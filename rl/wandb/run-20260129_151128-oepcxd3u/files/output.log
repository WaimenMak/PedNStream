Iteration 0: 100%|██████████| 5/5 [00:10<00:00,  2.01s/it]
Agent gate_2 episode reward: [-80.1707471]
All agents episode reward: [-80.1707471]
Agent gate_2 episode reward: [-8.69499194]
All agents episode reward: [-8.69499194]
Agent gate_2 episode reward: [-4.75595829]
All agents episode reward: [-4.75595829]
Agent gate_2 episode reward: [-5.86458793]
All agents episode reward: [-5.86458793]
Agent gate_2 episode reward: [-6.32834269]
All agents episode reward: [-6.32834269]
Iteration 1: 100%|██████████| 5/5 [00:08<00:00,  1.73s/it]
Agent gate_2 episode reward: [-17.80746865]
All agents episode reward: [-17.80746865]
Agent gate_2 episode reward: [-4.5483899]
All agents episode reward: [-4.5483899]
Agent gate_2 episode reward: [-4.04624098]
All agents episode reward: [-4.04624098]
Agent gate_2 episode reward: [-4.32134496]
All agents episode reward: [-4.32134496]
Agent gate_2 episode reward: [-5.17768347]
All agents episode reward: [-5.17768347]
Iteration 2: 100%|██████████| 5/5 [00:09<00:00,  1.94s/it]
Agent gate_2 episode reward: [-4.75953465]
All agents episode reward: [-4.75953465]
Agent gate_2 episode reward: [-4.89859662]
All agents episode reward: [-4.89859662]
Agent gate_2 episode reward: [-5.39514394]
All agents episode reward: [-5.39514394]
Agent gate_2 episode reward: [-16.33097722]
All agents episode reward: [-16.33097722]
Agent gate_2 episode reward: [-24.100093]
All agents episode reward: [-24.100093]
Iteration 3: 100%|██████████| 5/5 [00:10<00:00,  2.17s/it]
Agent gate_2 episode reward: [-3.17143454]
All agents episode reward: [-3.17143454]
Agent gate_2 episode reward: [-2.78861743]
All agents episode reward: [-2.78861743]
Agent gate_2 episode reward: [-4.69274409]
All agents episode reward: [-4.69274409]
Agent gate_2 episode reward: [-3.27903864]
All agents episode reward: [-3.27903864]
Agent gate_2 episode reward: [-2.75576857]
All agents episode reward: [-2.75576857]
Iteration 4: 100%|██████████| 5/5 [00:09<00:00,  1.83s/it]
Agent gate_2 episode reward: [-3.19564778]
All agents episode reward: [-3.19564778]
Agent gate_2 episode reward: [-3.01902529]
All agents episode reward: [-3.01902529]
Agent gate_2 episode reward: [-3.45141766]
All agents episode reward: [-3.45141766]
Agent gate_2 episode reward: [-3.14773916]
All agents episode reward: [-3.14773916]
Agent gate_2 episode reward: [-2.89120529]
All agents episode reward: [-2.89120529]
Iteration 5: 100%|██████████| 5/5 [00:13<00:00,  2.64s/it]
Agent gate_2 episode reward: [-3.85010496]
All agents episode reward: [-3.85010496]
Agent gate_2 episode reward: [-3.36830905]
All agents episode reward: [-3.36830905]
Agent gate_2 episode reward: [-4.35201564]
All agents episode reward: [-4.35201564]
Agent gate_2 episode reward: [-3.84355426]
All agents episode reward: [-3.84355426]
Saved 1 agents to ppo_agents_butterfly_scC
[Validation] New best avg return: -95722.047 at episode 30 (over 5 val episodes, saved to ppo_agents_butterfly_scC)
Agent gate_2 episode reward: [-3.54142991]
All agents episode reward: [-3.54142991]
Iteration 6: 100%|██████████| 5/5 [00:13<00:00,  2.64s/it]
Agent gate_2 episode reward: [-5.61944566]
All agents episode reward: [-5.61944566]
Agent gate_2 episode reward: [-8.08834504]
All agents episode reward: [-8.08834504]
Agent gate_2 episode reward: [-7.1140394]
All agents episode reward: [-7.1140394]
Agent gate_2 episode reward: [-7.14211774]
All agents episode reward: [-7.14211774]
Saved 1 agents to ppo_agents_butterfly_scC
[Validation] New best avg return: -89303.453 at episode 35 (over 5 val episodes, saved to ppo_agents_butterfly_scC)
Agent gate_2 episode reward: [-6.76026586]
All agents episode reward: [-6.76026586]
Iteration 7: 100%|██████████| 5/5 [00:12<00:00,  2.52s/it]
Agent gate_2 episode reward: [-9.22589048]
All agents episode reward: [-9.22589048]
Agent gate_2 episode reward: [-5.39464052]
All agents episode reward: [-5.39464052]
Agent gate_2 episode reward: [-5.27708896]
All agents episode reward: [-5.27708896]
Agent gate_2 episode reward: [-4.93331266]
All agents episode reward: [-4.93331266]
Agent gate_2 episode reward: [-4.88126838]
All agents episode reward: [-4.88126838]
Iteration 8: 100%|██████████| 5/5 [00:13<00:00,  2.67s/it]
Agent gate_2 episode reward: [-4.53059137]
All agents episode reward: [-4.53059137]
Agent gate_2 episode reward: [-4.79099751]
All agents episode reward: [-4.79099751]
Agent gate_2 episode reward: [-10.04540463]
All agents episode reward: [-10.04540463]
Agent gate_2 episode reward: [-5.22202217]
All agents episode reward: [-5.22202217]
Agent gate_2 episode reward: [-4.80601862]
All agents episode reward: [-4.80601862]
Iteration 9: 100%|██████████| 5/5 [00:12<00:00,  2.43s/it]
Agent gate_2 episode reward: [-5.56730889]
All agents episode reward: [-5.56730889]
Agent gate_2 episode reward: [-2.05229783]
All agents episode reward: [-2.05229783]
Agent gate_2 episode reward: [-1.65264217]
All agents episode reward: [-1.65264217]
Agent gate_2 episode reward: [-1.71164806]
All agents episode reward: [-1.71164806]
Agent gate_2 episode reward: [-6.00166824]
All agents episode reward: [-6.00166824]
Loaded 1 agents from ppo_agents_butterfly_scC
Running 10 evaluation runs...
  Run 1/10... Avg agent reward (episode): -59072.207 | Total reward: -59072.207
Saved run 1 to rl_training/butterfly_scC/ppo_run1
  Run 2/10... Avg agent reward (episode): -102483.672 | Total reward: -102483.672
Saved run 2 to rl_training/butterfly_scC/ppo_run2
  Run 3/10... Avg agent reward (episode): -118189.297 | Total reward: -118189.297
Saved run 3 to rl_training/butterfly_scC/ppo_run3
  Run 4/10... Avg agent reward (episode): -141595.109 | Total reward: -141595.109
Saved run 4 to rl_training/butterfly_scC/ppo_run4
  Run 5/10... Avg agent reward (episode): -94650.344 | Total reward: -94650.344
Saved run 5 to rl_training/butterfly_scC/ppo_run5
  Run 6/10... Avg agent reward (episode): -118097.211 | Total reward: -118097.211
Saved run 6 to rl_training/butterfly_scC/ppo_run6
  Run 7/10... Avg agent reward (episode): -126542.430 | Total reward: -126542.430
Saved run 7 to rl_training/butterfly_scC/ppo_run7
  Run 8/10... Avg agent reward (episode): -103605.281 | Total reward: -103605.281
Saved run 8 to rl_training/butterfly_scC/ppo_run8
  Run 9/10... Avg agent reward (episode): -108190.891 | Total reward: -108190.891
Saved run 9 to rl_training/butterfly_scC/ppo_run9
  Run 10/10... Avg agent reward (episode): -78750.461 | Total reward: -78750.461
Saved run 10 to rl_training/butterfly_scC/ppo_run10
============================================================
Evaluation Results
  Number of runs: 10
============================================================
  Agent gate_2: -105117.688 ± 22522.453
  Average reward: -105117.688 ± 22522.453
  Total reward: -105117.688 ± 22522.453
============================================================
Running 10 evaluation runs...
  Run 1/10... Avg agent reward (episode): -59072.207 | Total reward: -59072.207
Saved run 1 to rl_training/butterfly_scC/rule_based_run1
  Run 2/10... Avg agent reward (episode): -102483.672 | Total reward: -102483.672
Saved run 2 to rl_training/butterfly_scC/rule_based_run2
  Run 3/10... Avg agent reward (episode): -118189.297 | Total reward: -118189.297
Saved run 3 to rl_training/butterfly_scC/rule_based_run3
  Run 4/10... Avg agent reward (episode): -141595.109 | Total reward: -141595.109
Saved run 4 to rl_training/butterfly_scC/rule_based_run4
  Run 5/10... Avg agent reward (episode): -94650.344 | Total reward: -94650.344
Saved run 5 to rl_training/butterfly_scC/rule_based_run5
  Run 6/10... Avg agent reward (episode): -118097.211 | Total reward: -118097.211
Saved run 6 to rl_training/butterfly_scC/rule_based_run6
  Run 7/10... Avg agent reward (episode): -126542.430 | Total reward: -126542.430
Saved run 7 to rl_training/butterfly_scC/rule_based_run7
  Run 8/10... Avg agent reward (episode): -103605.281 | Total reward: -103605.281
Saved run 8 to rl_training/butterfly_scC/rule_based_run8
  Run 9/10... Avg agent reward (episode): -108190.891 | Total reward: -108190.891
Saved run 9 to rl_training/butterfly_scC/rule_based_run9
  Run 10/10... Avg agent reward (episode): -78750.461 | Total reward: -78750.461
Saved run 10 to rl_training/butterfly_scC/rule_based_run10
============================================================
Evaluation Results
  Number of runs: 10
============================================================
  Agent gate_2: -105117.688 ± 22522.453
  Average reward: -105117.688 ± 22522.453
  Total reward: -105117.688 ± 22522.453
============================================================
Running 10 evaluation runs...
  Run 1/10... No actions provided, skipping action application.
Avg agent reward (episode): -59072.207 | Total reward: -59072.207
Saved run 1 to rl_training/butterfly_scC/no_control_run1
  Run 2/10... No actions provided, skipping action application.
Avg agent reward (episode): -102483.672 | Total reward: -102483.672
Saved run 2 to rl_training/butterfly_scC/no_control_run2
  Run 3/10... No actions provided, skipping action application.
Avg agent reward (episode): -118189.297 | Total reward: -118189.297
Saved run 3 to rl_training/butterfly_scC/no_control_run3
  Run 4/10... No actions provided, skipping action application.
Avg agent reward (episode): -141595.109 | Total reward: -141595.109
Saved run 4 to rl_training/butterfly_scC/no_control_run4
  Run 5/10... No actions provided, skipping action application.
Avg agent reward (episode): -94650.344 | Total reward: -94650.344
Saved run 5 to rl_training/butterfly_scC/no_control_run5
  Run 6/10... No actions provided, skipping action application.
Avg agent reward (episode): -118097.211 | Total reward: -118097.211
Saved run 6 to rl_training/butterfly_scC/no_control_run6
  Run 7/10... No actions provided, skipping action application.
Avg agent reward (episode): -126542.430 | Total reward: -126542.430
Saved run 7 to rl_training/butterfly_scC/no_control_run7
  Run 8/10... No actions provided, skipping action application.
Avg agent reward (episode): -103605.281 | Total reward: -103605.281
Saved run 8 to rl_training/butterfly_scC/no_control_run8
  Run 9/10... No actions provided, skipping action application.
Avg agent reward (episode): -108190.891 | Total reward: -108190.891
Saved run 9 to rl_training/butterfly_scC/no_control_run9
  Run 10/10... No actions provided, skipping action application.
Avg agent reward (episode): -78750.461 | Total reward: -78750.461
Saved run 10 to rl_training/butterfly_scC/no_control_run10
============================================================
Evaluation Results
  Number of runs: 10
============================================================
  Agent gate_2: -105117.688 ± 22522.453
  Average reward: -105117.688 ± 22522.453
  Total reward: -105117.688 ± 22522.453
============================================================

============================================================
Comparison of All Methods
============================================================
ppo avg reward:        -105117.688
Rule-based avg reward: -105117.688
No control avg reward: -105117.688
============================================================
/Users/mmai/anaconda3/envs/control/lib/python3.11/site-packages/matplotlib/patches.py:3421: RuntimeWarning: invalid value encountered in scalar divide
  cos_t, sin_t = head_length / head_dist, head_width / head_dist
