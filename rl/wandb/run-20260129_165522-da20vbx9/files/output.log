Iteration 0: 100%|██████████| 10/10 [00:23<00:00,  2.34s/it, episode=10, norm_ret=-1955.192, true_ret=-876.541, steps=600]
Agent gate_2 episode reward: -4438.25927734375
All agents episode reward: -4438.25927734375
Agent gate_2 episode reward: -3442.180419921875
All agents episode reward: -3442.180419921875
Agent gate_2 episode reward: -2602.922607421875
All agents episode reward: -2602.922607421875
Agent gate_2 episode reward: -2453.3701171875
All agents episode reward: -2453.3701171875
Agent gate_2 episode reward: -1099.8157958984375
All agents episode reward: -1099.8157958984375
Agent gate_2 episode reward: -1427.535888671875
All agents episode reward: -1427.535888671875
Agent gate_2 episode reward: -1158.0438232421875
All agents episode reward: -1158.0438232421875
Agent gate_2 episode reward: -1030.231689453125
All agents episode reward: -1030.231689453125
Agent gate_2 episode reward: -1023.0198974609375
All agents episode reward: -1023.0198974609375
Agent gate_2 episode reward: -876.5411987304688
All agents episode reward: -876.5411987304688
Iteration 1: 100%|██████████| 10/10 [00:22<00:00,  2.21s/it, episode=20, norm_ret=-833.336, true_ret=-814.111, steps=600]
Agent gate_2 episode reward: -979.8275756835938
All agents episode reward: -979.8275756835938
Agent gate_2 episode reward: -801.9072875976562
All agents episode reward: -801.9072875976562
Agent gate_2 episode reward: -824.8638305664062
All agents episode reward: -824.8638305664062
Agent gate_2 episode reward: -836.4264526367188
All agents episode reward: -836.4264526367188
Agent gate_2 episode reward: -840.6939086914062
All agents episode reward: -840.6939086914062
Agent gate_2 episode reward: -847.62353515625
All agents episode reward: -847.62353515625
Agent gate_2 episode reward: -811.4137573242188
All agents episode reward: -811.4137573242188
Agent gate_2 episode reward: -808.5843505859375
All agents episode reward: -808.5843505859375
Agent gate_2 episode reward: -767.9110717773438
All agents episode reward: -767.9110717773438
Agent gate_2 episode reward: -814.1112060546875
All agents episode reward: -814.1112060546875
Iteration 2: 100%|██████████| 10/10 [00:24<00:00,  2.49s/it, episode=30, norm_ret=-826.767, true_ret=-770.590, steps=600]
Agent gate_2 episode reward: -820.6390380859375
All agents episode reward: -820.6390380859375
Agent gate_2 episode reward: -783.3012084960938
All agents episode reward: -783.3012084960938
Agent gate_2 episode reward: -792.1348266601562
All agents episode reward: -792.1348266601562
Agent gate_2 episode reward: -804.2418823242188
All agents episode reward: -804.2418823242188
Agent gate_2 episode reward: -810.9392700195312
All agents episode reward: -810.9392700195312
Agent gate_2 episode reward: -890.643310546875
All agents episode reward: -890.643310546875
Agent gate_2 episode reward: -853.270751953125
All agents episode reward: -853.270751953125
Agent gate_2 episode reward: -904.9096069335938
All agents episode reward: -904.9096069335938
Agent gate_2 episode reward: -836.9998168945312
All agents episode reward: -836.9998168945312
Agent gate_2 episode reward: -770.5899658203125
All agents episode reward: -770.5899658203125
Iteration 3: 100%|██████████| 10/10 [00:22<00:00,  2.28s/it, episode=40, norm_ret=-842.019, true_ret=-893.346, steps=600]
Agent gate_2 episode reward: -894.2288818359375
All agents episode reward: -894.2288818359375
Agent gate_2 episode reward: -819.3357543945312
All agents episode reward: -819.3357543945312
Agent gate_2 episode reward: -812.114501953125
All agents episode reward: -812.114501953125
Agent gate_2 episode reward: -878.0548095703125
All agents episode reward: -878.0548095703125
Agent gate_2 episode reward: -795.86572265625
All agents episode reward: -795.86572265625
Agent gate_2 episode reward: -801.9118041992188
All agents episode reward: -801.9118041992188
Agent gate_2 episode reward: -773.54248046875
All agents episode reward: -773.54248046875
Agent gate_2 episode reward: -915.376953125
All agents episode reward: -915.376953125
Agent gate_2 episode reward: -836.4153442382812
All agents episode reward: -836.4153442382812
Agent gate_2 episode reward: -893.34619140625
All agents episode reward: -893.34619140625
Iteration 4: 100%|██████████| 10/10 [00:23<00:00,  2.35s/it, episode=50, norm_ret=-814.500, true_ret=-773.357, steps=600]
Agent gate_2 episode reward: -794.9326782226562
All agents episode reward: -794.9326782226562
Agent gate_2 episode reward: -842.5866088867188
All agents episode reward: -842.5866088867188
Agent gate_2 episode reward: -766.2567749023438
All agents episode reward: -766.2567749023438
Agent gate_2 episode reward: -824.2420043945312
All agents episode reward: -824.2420043945312
Agent gate_2 episode reward: -842.3087158203125
All agents episode reward: -842.3087158203125
Agent gate_2 episode reward: -788.216796875
All agents episode reward: -788.216796875
Agent gate_2 episode reward: -777.46923828125
All agents episode reward: -777.46923828125
Agent gate_2 episode reward: -870.9266967773438
All agents episode reward: -870.9266967773438
Agent gate_2 episode reward: -864.701416015625
All agents episode reward: -864.701416015625
Agent gate_2 episode reward: -773.357177734375
All agents episode reward: -773.357177734375
Iteration 5: 100%|██████████| 10/10 [00:22<00:00,  2.23s/it, episode=60, norm_ret=-827.727, true_ret=-820.033, steps=600]
Agent gate_2 episode reward: -835.42431640625
All agents episode reward: -835.42431640625
Agent gate_2 episode reward: -819.5878295898438
All agents episode reward: -819.5878295898438
Agent gate_2 episode reward: -900.7041625976562
All agents episode reward: -900.7041625976562
Agent gate_2 episode reward: -936.8893432617188
All agents episode reward: -936.8893432617188
Saved 1 agents to ppo_agents_butterfly_scC
New best average return achieved: -913.562 at episode 55 (saved all agents to ppo_agents_butterfly_scC)
Agent gate_2 episode reward: -913.561767578125
All agents episode reward: -913.561767578125
Agent gate_2 episode reward: -831.2525024414062
All agents episode reward: -831.2525024414062
Agent gate_2 episode reward: -708.1300048828125
All agents episode reward: -708.1300048828125
Agent gate_2 episode reward: -671.83056640625
All agents episode reward: -671.83056640625
Agent gate_2 episode reward: -839.854736328125
All agents episode reward: -839.854736328125
Saved 1 agents to ppo_agents_butterfly_scC
New best average return achieved: -820.033 at episode 60 (saved all agents to ppo_agents_butterfly_scC)
Agent gate_2 episode reward: -820.0330200195312
All agents episode reward: -820.0330200195312
Iteration 6: 100%|██████████| 10/10 [00:22<00:00,  2.22s/it, episode=70, norm_ret=-865.339, true_ret=-778.617, steps=600]
Agent gate_2 episode reward: -822.2648315429688
All agents episode reward: -822.2648315429688
Agent gate_2 episode reward: -823.36328125
All agents episode reward: -823.36328125
Agent gate_2 episode reward: -872.3805541992188
All agents episode reward: -872.3805541992188
Agent gate_2 episode reward: -814.3310546875
All agents episode reward: -814.3310546875
Agent gate_2 episode reward: -831.7376098632812
All agents episode reward: -831.7376098632812
Agent gate_2 episode reward: -858.577392578125
All agents episode reward: -858.577392578125
Agent gate_2 episode reward: -951.1971435546875
All agents episode reward: -951.1971435546875
Agent gate_2 episode reward: -1031.7894287109375
All agents episode reward: -1031.7894287109375
Agent gate_2 episode reward: -869.12744140625
All agents episode reward: -869.12744140625
Saved 1 agents to ppo_agents_butterfly_scC
New best average return achieved: -778.617 at episode 70 (saved all agents to ppo_agents_butterfly_scC)
Agent gate_2 episode reward: -778.6174926757812
All agents episode reward: -778.6174926757812
Iteration 7: 100%|██████████| 10/10 [00:22<00:00,  2.27s/it, episode=80, norm_ret=-838.031, true_ret=-876.444, steps=600]
Agent gate_2 episode reward: -918.3388061523438
All agents episode reward: -918.3388061523438
Agent gate_2 episode reward: -831.9920654296875
All agents episode reward: -831.9920654296875
Agent gate_2 episode reward: -813.0194091796875
All agents episode reward: -813.0194091796875
Agent gate_2 episode reward: -787.0668334960938
All agents episode reward: -787.0668334960938
Agent gate_2 episode reward: -820.4987182617188
All agents episode reward: -820.4987182617188
Agent gate_2 episode reward: -810.1402587890625
All agents episode reward: -810.1402587890625
Agent gate_2 episode reward: -826.9276733398438
All agents episode reward: -826.9276733398438
Agent gate_2 episode reward: -849.5813598632812
All agents episode reward: -849.5813598632812
Agent gate_2 episode reward: -846.2966918945312
All agents episode reward: -846.2966918945312
Agent gate_2 episode reward: -876.4441528320312
All agents episode reward: -876.4441528320312
Iteration 8: 100%|██████████| 10/10 [00:22<00:00,  2.22s/it, episode=90, norm_ret=-807.554, true_ret=-790.788, steps=600]
Agent gate_2 episode reward: -775.5051879882812
All agents episode reward: -775.5051879882812
Agent gate_2 episode reward: -881.1498413085938
All agents episode reward: -881.1498413085938
Agent gate_2 episode reward: -814.3925170898438
All agents episode reward: -814.3925170898438
Agent gate_2 episode reward: -791.2830200195312
All agents episode reward: -791.2830200195312
Agent gate_2 episode reward: -798.2738647460938
All agents episode reward: -798.2738647460938
Agent gate_2 episode reward: -806.6336059570312
All agents episode reward: -806.6336059570312
Agent gate_2 episode reward: -825.941650390625
All agents episode reward: -825.941650390625
Agent gate_2 episode reward: -825.22802734375
All agents episode reward: -825.22802734375
Agent gate_2 episode reward: -766.3455810546875
All agents episode reward: -766.3455810546875
Agent gate_2 episode reward: -790.7879028320312
All agents episode reward: -790.7879028320312
Iteration 9: 100%|██████████| 10/10 [00:22<00:00,  2.28s/it, episode=100, norm_ret=-809.805, true_ret=-759.178, steps=600]
Agent gate_2 episode reward: -752.964111328125
All agents episode reward: -752.964111328125
Agent gate_2 episode reward: -784.2725219726562
All agents episode reward: -784.2725219726562
Agent gate_2 episode reward: -804.0139770507812
All agents episode reward: -804.0139770507812
Agent gate_2 episode reward: -828.3403930664062
All agents episode reward: -828.3403930664062
Agent gate_2 episode reward: -847.3704223632812
All agents episode reward: -847.3704223632812
Agent gate_2 episode reward: -781.1219482421875
All agents episode reward: -781.1219482421875
Agent gate_2 episode reward: -809.118408203125
All agents episode reward: -809.118408203125
Agent gate_2 episode reward: -846.0435791015625
All agents episode reward: -846.0435791015625
Agent gate_2 episode reward: -885.6251831054688
All agents episode reward: -885.6251831054688
Saved 1 agents to ppo_agents_butterfly_scC
New best average return achieved: -759.178 at episode 100 (saved all agents to ppo_agents_butterfly_scC)
Agent gate_2 episode reward: -759.1780395507812
All agents episode reward: -759.1780395507812
Loaded 1 agents from ppo_agents_butterfly_scC
Running 10 evaluation runs...
  Run 1/10... Avg agent reward (episode): -589.514 | Total reward: -589.514
Saved run 1 to rl_training/butterfly_scC/ppo_run1
  Run 2/10... Avg agent reward (episode): -1023.275 | Total reward: -1023.275
Saved run 2 to rl_training/butterfly_scC/ppo_run2
  Run 3/10... Avg agent reward (episode): -1180.363 | Total reward: -1180.363
Saved run 3 to rl_training/butterfly_scC/ppo_run3
  Run 4/10... Avg agent reward (episode): -1414.308 | Total reward: -1414.308
Saved run 4 to rl_training/butterfly_scC/ppo_run4
  Run 5/10... Avg agent reward (episode): -945.117 | Total reward: -945.117
Saved run 5 to rl_training/butterfly_scC/ppo_run5
  Run 6/10... Avg agent reward (episode): -1179.414 | Total reward: -1179.414
Saved run 6 to rl_training/butterfly_scC/ppo_run6
  Run 7/10... Avg agent reward (episode): -1263.859 | Total reward: -1263.859
Saved run 7 to rl_training/butterfly_scC/ppo_run7
  Run 8/10... Avg agent reward (episode): -1034.603 | Total reward: -1034.603
Saved run 8 to rl_training/butterfly_scC/ppo_run8
  Run 9/10... Avg agent reward (episode): -1080.338 | Total reward: -1080.338
Saved run 9 to rl_training/butterfly_scC/ppo_run9
  Run 10/10... Avg agent reward (episode): -786.026 | Total reward: -786.026
Saved run 10 to rl_training/butterfly_scC/ppo_run10
============================================================
Evaluation Results
  Number of runs: 10
============================================================
  Agent gate_2: -1049.682 ± 225.122
  Average reward: -1049.682 ± 225.122
  Total reward: -1049.682 ± 225.122
============================================================
Running 10 evaluation runs...
  Run 1/10... Avg agent reward (episode): -589.514 | Total reward: -589.514
Saved run 1 to rl_training/butterfly_scC/rule_based_run1
  Run 2/10... Avg agent reward (episode): -1023.275 | Total reward: -1023.275
Saved run 2 to rl_training/butterfly_scC/rule_based_run2
  Run 3/10... Avg agent reward (episode): -1180.363 | Total reward: -1180.363
Saved run 3 to rl_training/butterfly_scC/rule_based_run3
  Run 4/10... Avg agent reward (episode): -1414.308 | Total reward: -1414.308
Saved run 4 to rl_training/butterfly_scC/rule_based_run4
  Run 5/10... Avg agent reward (episode): -945.117 | Total reward: -945.117
Saved run 5 to rl_training/butterfly_scC/rule_based_run5
  Run 6/10... Avg agent reward (episode): -1179.414 | Total reward: -1179.414
Saved run 6 to rl_training/butterfly_scC/rule_based_run6
  Run 7/10... Avg agent reward (episode): -1263.859 | Total reward: -1263.859
Saved run 7 to rl_training/butterfly_scC/rule_based_run7
  Run 8/10... Avg agent reward (episode): -1034.603 | Total reward: -1034.603
Saved run 8 to rl_training/butterfly_scC/rule_based_run8
  Run 9/10... Avg agent reward (episode): -1080.338 | Total reward: -1080.338
Saved run 9 to rl_training/butterfly_scC/rule_based_run9
  Run 10/10... Avg agent reward (episode): -786.026 | Total reward: -786.026
Saved run 10 to rl_training/butterfly_scC/rule_based_run10
============================================================
Evaluation Results
  Number of runs: 10
============================================================
  Agent gate_2: -1049.682 ± 225.122
  Average reward: -1049.682 ± 225.122
  Total reward: -1049.682 ± 225.122
============================================================
Running 10 evaluation runs...
  Run 1/10... No actions provided, skipping action application.
Avg agent reward (episode): -589.514 | Total reward: -589.514
Saved run 1 to rl_training/butterfly_scC/no_control_run1
  Run 2/10... No actions provided, skipping action application.
Avg agent reward (episode): -1023.275 | Total reward: -1023.275
Saved run 2 to rl_training/butterfly_scC/no_control_run2
  Run 3/10... No actions provided, skipping action application.
Avg agent reward (episode): -1180.363 | Total reward: -1180.363
Saved run 3 to rl_training/butterfly_scC/no_control_run3
  Run 4/10... No actions provided, skipping action application.
Avg agent reward (episode): -1414.308 | Total reward: -1414.308
Saved run 4 to rl_training/butterfly_scC/no_control_run4
  Run 5/10... No actions provided, skipping action application.
Avg agent reward (episode): -945.117 | Total reward: -945.117
Saved run 5 to rl_training/butterfly_scC/no_control_run5
  Run 6/10... No actions provided, skipping action application.
Avg agent reward (episode): -1179.414 | Total reward: -1179.414
Saved run 6 to rl_training/butterfly_scC/no_control_run6
  Run 7/10... No actions provided, skipping action application.
Avg agent reward (episode): -1263.859 | Total reward: -1263.859
Saved run 7 to rl_training/butterfly_scC/no_control_run7
  Run 8/10... No actions provided, skipping action application.
Avg agent reward (episode): -1034.603 | Total reward: -1034.603
Saved run 8 to rl_training/butterfly_scC/no_control_run8
  Run 9/10... No actions provided, skipping action application.
Avg agent reward (episode): -1080.338 | Total reward: -1080.338
Saved run 9 to rl_training/butterfly_scC/no_control_run9
  Run 10/10... No actions provided, skipping action application.
Avg agent reward (episode): -786.026 | Total reward: -786.026
Saved run 10 to rl_training/butterfly_scC/no_control_run10
============================================================
Evaluation Results
  Number of runs: 10
============================================================
  Agent gate_2: -1049.682 ± 225.122
  Average reward: -1049.682 ± 225.122
  Total reward: -1049.682 ± 225.122
============================================================

============================================================
Comparison of All Methods
============================================================
ppo avg reward:        -1049.682
Rule-based avg reward: -1049.682
No control avg reward: -1049.682
============================================================
/Users/mmai/anaconda3/envs/control/lib/python3.11/site-packages/matplotlib/patches.py:3421: RuntimeWarning: invalid value encountered in scalar divide
  cos_t, sin_t = head_length / head_dist, head_width / head_dist
