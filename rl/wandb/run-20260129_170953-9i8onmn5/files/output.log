Iteration 0: 100%|██████████| 10/10 [00:15<00:00,  1.58s/it, episode=10, norm_ret=-12.076, true_ret=-876.071, steps=300]
Agent gate_2 episode reward: [-59.0737036]
All agents episode reward: [-59.0737036]
Agent gate_2 episode reward: [-6.59172667]
All agents episode reward: [-6.59172667]
Agent gate_2 episode reward: [-4.60148925]
All agents episode reward: [-4.60148925]
Agent gate_2 episode reward: [-8.65531475]
All agents episode reward: [-8.65531475]
Agent gate_2 episode reward: [-7.60212147]
All agents episode reward: [-7.60212147]
Agent gate_2 episode reward: [-5.20331056]
All agents episode reward: [-5.20331056]
Agent gate_2 episode reward: [-8.92162683]
All agents episode reward: [-8.92162683]
Agent gate_2 episode reward: [-7.52199316]
All agents episode reward: [-7.52199316]
Agent gate_2 episode reward: [-7.19778637]
All agents episode reward: [-7.19778637]
Agent gate_2 episode reward: [-5.38980141]
All agents episode reward: [-5.38980141]
Iteration 1: 100%|██████████| 10/10 [00:15<00:00,  1.53s/it, episode=20, norm_ret=-6.169, true_ret=-623.256, steps=300]
Agent gate_2 episode reward: [-6.3524512]
All agents episode reward: [-6.3524512]
Agent gate_2 episode reward: [-8.85352979]
All agents episode reward: [-8.85352979]
Agent gate_2 episode reward: [-4.32316963]
All agents episode reward: [-4.32316963]
Agent gate_2 episode reward: [-6.16333122]
All agents episode reward: [-6.16333122]
Agent gate_2 episode reward: [-7.44912325]
All agents episode reward: [-7.44912325]
Agent gate_2 episode reward: [-5.88197919]
All agents episode reward: [-5.88197919]
Agent gate_2 episode reward: [-6.92170094]
All agents episode reward: [-6.92170094]
Agent gate_2 episode reward: [-4.52153027]
All agents episode reward: [-4.52153027]
Agent gate_2 episode reward: [-7.43543397]
All agents episode reward: [-7.43543397]
Agent gate_2 episode reward: [-3.79088857]
All agents episode reward: [-3.79088857]
Iteration 2: 100%|██████████| 10/10 [00:14<00:00,  1.42s/it, episode=30, norm_ret=-4.148, true_ret=-67.796, steps=300]
Agent gate_2 episode reward: [-3.57436119]
All agents episode reward: [-3.57436119]
Agent gate_2 episode reward: [-6.21726393]
All agents episode reward: [-6.21726393]
Agent gate_2 episode reward: [-7.08679082]
All agents episode reward: [-7.08679082]
Agent gate_2 episode reward: [-6.94136801]
All agents episode reward: [-6.94136801]
Agent gate_2 episode reward: [-1.60666089]
All agents episode reward: [-1.60666089]
Agent gate_2 episode reward: [-2.15571633]
All agents episode reward: [-2.15571633]
Agent gate_2 episode reward: [-0.46352679]
All agents episode reward: [-0.46352679]
Agent gate_2 episode reward: [-7.27152366]
All agents episode reward: [-7.27152366]
Agent gate_2 episode reward: [-5.73854419]
All agents episode reward: [-5.73854419]
Agent gate_2 episode reward: [-0.42067566]
All agents episode reward: [-0.42067566]
Iteration 3: 100%|██████████| 10/10 [00:13<00:00,  1.39s/it, episode=40, norm_ret=-4.506, true_ret=-1084.252, steps=300]
Agent gate_2 episode reward: [-0.39638966]
All agents episode reward: [-0.39638966]
Agent gate_2 episode reward: [-4.20624869]
All agents episode reward: [-4.20624869]
Agent gate_2 episode reward: [-2.08774099]
All agents episode reward: [-2.08774099]
Agent gate_2 episode reward: [-6.81570528]
All agents episode reward: [-6.81570528]
Agent gate_2 episode reward: [0.]
All agents episode reward: [0.]
Agent gate_2 episode reward: [-5.90872694]
All agents episode reward: [-5.90872694]
Agent gate_2 episode reward: [-6.71324858]
All agents episode reward: [-6.71324858]
Agent gate_2 episode reward: [-5.94078764]
All agents episode reward: [-5.94078764]
Agent gate_2 episode reward: [-6.13219986]
All agents episode reward: [-6.13219986]
Agent gate_2 episode reward: [-6.85889391]
All agents episode reward: [-6.85889391]
Iteration 4: 100%|██████████| 10/10 [00:15<00:00,  1.52s/it, episode=50, norm_ret=-5.049, true_ret=-962.894, steps=300]
Agent gate_2 episode reward: [-7.11823697]
All agents episode reward: [-7.11823697]
Agent gate_2 episode reward: [-4.33952937]
All agents episode reward: [-4.33952937]
Agent gate_2 episode reward: [-3.53102837]
All agents episode reward: [-3.53102837]
Agent gate_2 episode reward: [-6.71234275]
All agents episode reward: [-6.71234275]
Agent gate_2 episode reward: [-3.40773271]
All agents episode reward: [-3.40773271]
Agent gate_2 episode reward: [-5.00234853]
All agents episode reward: [-5.00234853]
Agent gate_2 episode reward: [-7.52891422]
All agents episode reward: [-7.52891422]
Agent gate_2 episode reward: [-6.71035667]
All agents episode reward: [-6.71035667]
Agent gate_2 episode reward: [0.]
All agents episode reward: [0.]
Agent gate_2 episode reward: [-6.14304441]
All agents episode reward: [-6.14304441]
Iteration 5: 100%|██████████| 10/10 [00:15<00:00,  1.51s/it, episode=60, norm_ret=-3.706, true_ret=-615.021, steps=300]
Agent gate_2 episode reward: [-6.39634168]
All agents episode reward: [-6.39634168]
Agent gate_2 episode reward: [-6.2748908]
All agents episode reward: [-6.2748908]
Agent gate_2 episode reward: [-0.64958492]
All agents episode reward: [-0.64958492]
Agent gate_2 episode reward: [-5.63428258]
All agents episode reward: [-5.63428258]
Saved 1 agents to ppo_agents_butterfly_scC
New best average return achieved: -8.214 at episode 55 (saved all agents to ppo_agents_butterfly_scC)
Agent gate_2 episode reward: [-8.21352505]
All agents episode reward: [-8.21352505]
Agent gate_2 episode reward: [-0.44903097]
All agents episode reward: [-0.44903097]
Agent gate_2 episode reward: [0.]
All agents episode reward: [0.]
Agent gate_2 episode reward: [-2.4508679]
All agents episode reward: [-2.4508679]
Agent gate_2 episode reward: [-3.02761643]
All agents episode reward: [-3.02761643]
Saved 1 agents to ppo_agents_butterfly_scC
New best average return achieved: -3.964 at episode 60 (saved all agents to ppo_agents_butterfly_scC)
Agent gate_2 episode reward: [-3.96370185]
All agents episode reward: [-3.96370185]
Iteration 6: 100%|██████████| 10/10 [00:13<00:00,  1.40s/it, episode=70, norm_ret=-4.079, true_ret=-81.721, steps=300]
Agent gate_2 episode reward: [-4.10867265]
All agents episode reward: [-4.10867265]
Agent gate_2 episode reward: [-7.34727519]
All agents episode reward: [-7.34727519]
Agent gate_2 episode reward: [-7.73415241]
All agents episode reward: [-7.73415241]
Agent gate_2 episode reward: [-6.48065144]
All agents episode reward: [-6.48065144]
Agent gate_2 episode reward: [-5.44262226]
All agents episode reward: [-5.44262226]
Agent gate_2 episode reward: [-5.5603337]
All agents episode reward: [-5.5603337]
Agent gate_2 episode reward: [-0.56489539]
All agents episode reward: [-0.56489539]
Agent gate_2 episode reward: [-3.01817306]
All agents episode reward: [-3.01817306]
Agent gate_2 episode reward: [-0.00396605]
All agents episode reward: [-0.00396605]
Saved 1 agents to ppo_agents_butterfly_scC
New best average return achieved: -0.533 at episode 70 (saved all agents to ppo_agents_butterfly_scC)
Agent gate_2 episode reward: [-0.53286905]
All agents episode reward: [-0.53286905]
Iteration 7: 100%|██████████| 10/10 [00:14<00:00,  1.48s/it, episode=80, norm_ret=-5.039, true_ret=-3.917, steps=300]
Agent gate_2 episode reward: [-0.52171693]
All agents episode reward: [-0.52171693]
Agent gate_2 episode reward: [-4.6104581]
All agents episode reward: [-4.6104581]
Agent gate_2 episode reward: [-8.40005183]
All agents episode reward: [-8.40005183]
Agent gate_2 episode reward: [-6.47320576]
All agents episode reward: [-6.47320576]
Agent gate_2 episode reward: [-8.98053226]
All agents episode reward: [-8.98053226]
Agent gate_2 episode reward: [-8.69696439]
All agents episode reward: [-8.69696439]
Agent gate_2 episode reward: [-6.90311483]
All agents episode reward: [-6.90311483]
Agent gate_2 episode reward: [-0.12986029]
All agents episode reward: [-0.12986029]
Agent gate_2 episode reward: [-5.64611554]
All agents episode reward: [-5.64611554]
Saved 1 agents to ppo_agents_butterfly_scC
New best average return achieved: -0.025 at episode 80 (saved all agents to ppo_agents_butterfly_scC)
Agent gate_2 episode reward: [-0.02508952]
All agents episode reward: [-0.02508952]
Iteration 8: 100%|██████████| 10/10 [00:14<00:00,  1.42s/it, episode=90, norm_ret=-4.745, true_ret=-571.473, steps=300]
Agent gate_2 episode reward: [-0.01170612]
All agents episode reward: [-0.01170612]
Agent gate_2 episode reward: [-5.35081038]
All agents episode reward: [-5.35081038]
Agent gate_2 episode reward: [-6.47255253]
All agents episode reward: [-6.47255253]
Agent gate_2 episode reward: [-4.88561099]
All agents episode reward: [-4.88561099]
Agent gate_2 episode reward: [-4.02519715]
All agents episode reward: [-4.02519715]
Agent gate_2 episode reward: [-6.46418025]
All agents episode reward: [-6.46418025]
Agent gate_2 episode reward: [-5.01215908]
All agents episode reward: [-5.01215908]
Agent gate_2 episode reward: [-6.79960912]
All agents episode reward: [-6.79960912]
Agent gate_2 episode reward: [-4.7071214]
All agents episode reward: [-4.7071214]
Agent gate_2 episode reward: [-3.72001667]
All agents episode reward: [-3.72001667]
Iteration 9: 100%|██████████| 10/10 [00:14<00:00,  1.44s/it, episode=100, norm_ret=-5.092, true_ret=-821.414, steps=300]
Agent gate_2 episode reward: [-4.02583703]
All agents episode reward: [-4.02583703]
Agent gate_2 episode reward: [-4.75751585]
All agents episode reward: [-4.75751585]
Agent gate_2 episode reward: [-5.35390176]
All agents episode reward: [-5.35390176]
Agent gate_2 episode reward: [-0.25409918]
All agents episode reward: [-0.25409918]
Agent gate_2 episode reward: [-7.40137457]
All agents episode reward: [-7.40137457]
Agent gate_2 episode reward: [-3.30950964]
All agents episode reward: [-3.30950964]
Agent gate_2 episode reward: [-6.56827311]
All agents episode reward: [-6.56827311]
Agent gate_2 episode reward: [-7.59597815]
All agents episode reward: [-7.59597815]
Agent gate_2 episode reward: [-6.2563939]
All agents episode reward: [-6.2563939]
Agent gate_2 episode reward: [-5.39944945]
All agents episode reward: [-5.39944945]
Loaded 1 agents from ppo_agents_butterfly_scC
Running 10 evaluation runs...
  Run 1/10... Avg agent reward (episode): -589.514 | Total reward: -589.514
Saved run 1 to rl_training/butterfly_scC/ppo_run1
  Run 2/10... Avg agent reward (episode): -1023.275 | Total reward: -1023.275
Saved run 2 to rl_training/butterfly_scC/ppo_run2
  Run 3/10... Avg agent reward (episode): -1180.363 | Total reward: -1180.363
Saved run 3 to rl_training/butterfly_scC/ppo_run3
  Run 4/10... Avg agent reward (episode): -1414.308 | Total reward: -1414.308
Saved run 4 to rl_training/butterfly_scC/ppo_run4
  Run 5/10... Avg agent reward (episode): -945.117 | Total reward: -945.117
Saved run 5 to rl_training/butterfly_scC/ppo_run5
  Run 6/10... Avg agent reward (episode): -1179.414 | Total reward: -1179.414
Saved run 6 to rl_training/butterfly_scC/ppo_run6
  Run 7/10... Avg agent reward (episode): -1263.859 | Total reward: -1263.859
Saved run 7 to rl_training/butterfly_scC/ppo_run7
  Run 8/10... Avg agent reward (episode): -1034.603 | Total reward: -1034.603
Saved run 8 to rl_training/butterfly_scC/ppo_run8
  Run 9/10... Avg agent reward (episode): -1080.338 | Total reward: -1080.338
Saved run 9 to rl_training/butterfly_scC/ppo_run9
  Run 10/10... Avg agent reward (episode): -786.026 | Total reward: -786.026
Saved run 10 to rl_training/butterfly_scC/ppo_run10
============================================================
Evaluation Results
  Number of runs: 10
============================================================
  Agent gate_2: -1049.682 ± 225.122
  Average reward: -1049.682 ± 225.122
  Total reward: -1049.682 ± 225.122
============================================================
Running 10 evaluation runs...
  Run 1/10... Avg agent reward (episode): -589.514 | Total reward: -589.514
Saved run 1 to rl_training/butterfly_scC/rule_based_run1
  Run 2/10... Avg agent reward (episode): -1023.275 | Total reward: -1023.275
Saved run 2 to rl_training/butterfly_scC/rule_based_run2
  Run 3/10... Avg agent reward (episode): -1180.363 | Total reward: -1180.363
Saved run 3 to rl_training/butterfly_scC/rule_based_run3
  Run 4/10... Avg agent reward (episode): -1414.309 | Total reward: -1414.309
Saved run 4 to rl_training/butterfly_scC/rule_based_run4
  Run 5/10... Avg agent reward (episode): -945.117 | Total reward: -945.117
Saved run 5 to rl_training/butterfly_scC/rule_based_run5
  Run 6/10... Avg agent reward (episode): -1179.415 | Total reward: -1179.415
Saved run 6 to rl_training/butterfly_scC/rule_based_run6
  Run 7/10... Avg agent reward (episode): -1263.859 | Total reward: -1263.859
Saved run 7 to rl_training/butterfly_scC/rule_based_run7
  Run 8/10... Avg agent reward (episode): -1034.603 | Total reward: -1034.603
Saved run 8 to rl_training/butterfly_scC/rule_based_run8
  Run 9/10... Avg agent reward (episode): -1080.339 | Total reward: -1080.339
Saved run 9 to rl_training/butterfly_scC/rule_based_run9
  Run 10/10...
