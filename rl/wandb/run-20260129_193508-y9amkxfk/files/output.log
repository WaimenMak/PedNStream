Iteration 0:  53%|█████▎    | 16/30 [10:22<03:09, 13.55s/it, episode=10, norm_ret=-10.780, true_ret=-460268480.000, steps=600]
Agent gate_2 episode reward: [-66.19236602]
All agents episode reward: [-66.19236602]
Agent gate_2 episode reward: [-27.53225369]
All agents episode reward: [-27.53225369]
Agent gate_2 episode reward: [-1.73666448]
All agents episode reward: [-1.73666448]
Agent gate_2 episode reward: [-4.83550149]
All agents episode reward: [-4.83550149]
Agent gate_2 episode reward: [0.]
All agents episode reward: [0.]
Agent gate_2 episode reward: [-0.7716918]
All agents episode reward: [-0.7716918]
Agent gate_2 episode reward: [-1.2164162]
All agents episode reward: [-1.2164162]
Agent gate_2 episode reward: [-2.28210602]
All agents episode reward: [-2.28210602]
Agent gate_2 episode reward: [-0.82948708]
All agents episode reward: [-0.82948708]
Agent gate_2 episode reward: [-2.40767236]
All agents episode reward: [-2.40767236]
Agent gate_2 episode reward: [-1.23061356]
All agents episode reward: [-1.23061356]
Agent gate_2 episode reward: [-2.06654782]
All agents episode reward: [-2.06654782]
Agent gate_2 episode reward: [-2.50948617]
All agents episode reward: [-2.50948617]
Agent gate_2 episode reward: [-2.00130105]
All agents episode reward: [-2.00130105]
Agent gate_2 episode reward: [-1.15704245]
All agents episode reward: [-1.15704245]
Agent gate_2 episode reward: [-3.27221378]
All agents episode reward: [-3.27221378]
Agent gate_2 episode reward: [-2.85046688]
All agents episode reward: [-2.85046688]
Agent gate_2 episode reward: [-3.20743112]
All agents episode reward: [-3.20743112]
Agent gate_2 episode reward: [-2.20349284]
All agents episode reward: [-2.20349284]
Agent gate_2 episode reward: [-3.1766952]
All agents episode reward: [-3.1766952]
Agent gate_2 episode reward: [-3.1957603]
All agents episode reward: [-3.1957603]
Agent gate_2 episode reward: [-1.66087767]
All agents episode reward: [-1.66087767]
Agent gate_2 episode reward: [-3.29961705]
All agents episode reward: [-3.29961705]
Agent gate_2 episode reward: [-3.47607183]
All agents episode reward: [-3.47607183]
Agent gate_2 episode reward: [-3.45345948]
All agents episode reward: [-3.45345948]
Agent gate_2 episode reward: [-3.82572306]
All agents episode reward: [-3.82572306]
Agent gate_2 episode reward: [-3.88146622]
All agents episode reward: [-3.88146622]
Agent gate_2 episode reward: [-1.62149266]
All agents episode reward: [-1.62149266]
Agent gate_2 episode reward: [-1.74128271]
All agents episode reward: [-1.74128271]
Agent gate_2 episode reward: [-1.13160633]
All agents episode reward: [-1.13160633]
Iteration 1:  53%|█████▎    | 16/30 [00:37<00:33,  2.37s/it, episode=40, norm_ret=-2.019, true_ret=-343857824.000, steps=600]
Agent gate_2 episode reward: [-2.53022911]
All agents episode reward: [-2.53022911]
Agent gate_2 episode reward: [-3.77730254]
All agents episode reward: [-3.77730254]
Agent gate_2 episode reward: [-1.84469817]
All agents episode reward: [-1.84469817]
Agent gate_2 episode reward: [-3.4304837]
All agents episode reward: [-3.4304837]
Agent gate_2 episode reward: [-1.61730727]
All agents episode reward: [-1.61730727]
Agent gate_2 episode reward: [-0.21597259]
All agents episode reward: [-0.21597259]
Agent gate_2 episode reward: [0.]
All agents episode reward: [0.]
Agent gate_2 episode reward: [-3.39470977]
All agents episode reward: [-3.39470977]
Agent gate_2 episode reward: [0.]
All agents episode reward: [0.]
Agent gate_2 episode reward: [-3.37885252]
All agents episode reward: [-3.37885252]
Agent gate_2 episode reward: [-3.47280118]
All agents episode reward: [-3.47280118]
Agent gate_2 episode reward: [-4.87246055]
All agents episode reward: [-4.87246055]
Agent gate_2 episode reward: [-2.06837284]
All agents episode reward: [-2.06837284]
Agent gate_2 episode reward: [-4.30833292]
All agents episode reward: [-4.30833292]
Agent gate_2 episode reward: [-1.98853509]
All agents episode reward: [-1.98853509]
Agent gate_2 episode reward: [-2.50428527]
All agents episode reward: [-2.50428527]
Agent gate_2 episode reward: [-4.32177073]
All agents episode reward: [-4.32177073]
Agent gate_2 episode reward: [-4.70966447]
All agents episode reward: [-4.70966447]
Agent gate_2 episode reward: [-4.51568374]
All agents episode reward: [-4.51568374]
Agent gate_2 episode reward: [-4.28348609]
All agents episode reward: [-4.28348609]
Agent gate_2 episode reward: [-2.22857118]
All agents episode reward: [-2.22857118]
Agent gate_2 episode reward: [-3.31089935]
All agents episode reward: [-3.31089935]
Agent gate_2 episode reward: [-4.76661465]
All agents episode reward: [-4.76661465]
Agent gate_2 episode reward: [-3.34883737]
All agents episode reward: [-3.34883737]
Agent gate_2 episode reward: [-2.47457835]
All agents episode reward: [-2.47457835]
Agent gate_2 episode reward: [-2.59719279]
All agents episode reward: [-2.59719279]
Agent gate_2 episode reward: [-5.74408063]
All agents episode reward: [-5.74408063]
Agent gate_2 episode reward: [-3.94266195]
All agents episode reward: [-3.94266195]
Agent gate_2 episode reward: [-4.13037453]
All agents episode reward: [-4.13037453]
Agent gate_2 episode reward: [-1.86238698]
All agents episode reward: [-1.86238698]
Iteration 2:  53%|█████▎    | 16/30 [00:37<00:32,  2.33s/it, episode=70, norm_ret=-3.661, true_ret=-1461144.750, steps=600]
Agent gate_2 episode reward: [-1.57171326]
All agents episode reward: [-1.57171326]
Agent gate_2 episode reward: [-5.34439661]
All agents episode reward: [-5.34439661]
Agent gate_2 episode reward: [-5.5053156]
All agents episode reward: [-5.5053156]
Agent gate_2 episode reward: [-3.48718073]
All agents episode reward: [-3.48718073]
Agent gate_2 episode reward: [-3.29706128]
All agents episode reward: [-3.29706128]
Agent gate_2 episode reward: [-2.71503526]
All agents episode reward: [-2.71503526]
Agent gate_2 episode reward: [-3.40238891]
All agents episode reward: [-3.40238891]
Agent gate_2 episode reward: [-6.44739877]
All agents episode reward: [-6.44739877]
Agent gate_2 episode reward: [-4.8188415]
All agents episode reward: [-4.8188415]
Agent gate_2 episode reward: [-0.01813645]
All agents episode reward: [-0.01813645]
Agent gate_2 episode reward: [-3.9265538]
All agents episode reward: [-3.9265538]
Agent gate_2 episode reward: [-5.12967671]
All agents episode reward: [-5.12967671]
Agent gate_2 episode reward: [-4.55527727]
All agents episode reward: [-4.55527727]
Agent gate_2 episode reward: [-3.6437611]
All agents episode reward: [-3.6437611]
Agent gate_2 episode reward: [-2.83651699]
All agents episode reward: [-2.83651699]
Agent gate_2 episode reward: [-2.66612036]
All agents episode reward: [-2.66612036]
Agent gate_2 episode reward: [-5.26627309]
All agents episode reward: [-5.26627309]
Agent gate_2 episode reward: [-4.57011512]
All agents episode reward: [-4.57011512]
Agent gate_2 episode reward: [-5.65136483]
All agents episode reward: [-5.65136483]
Agent gate_2 episode reward: [-2.09989275]
All agents episode reward: [-2.09989275]
Agent gate_2 episode reward: [-3.41886315]
All agents episode reward: [-3.41886315]
Agent gate_2 episode reward: [-4.97181037]
All agents episode reward: [-4.97181037]
Agent gate_2 episode reward: [-5.58528919]
All agents episode reward: [-5.58528919]
Agent gate_2 episode reward: [-3.90982814]
All agents episode reward: [-3.90982814]
Agent gate_2 episode reward: [-4.8885501]
All agents episode reward: [-4.8885501]
Agent gate_2 episode reward: [-2.08857515]
All agents episode reward: [-2.08857515]
Agent gate_2 episode reward: [0.]
All agents episode reward: [0.]
Agent gate_2 episode reward: [-5.68826397]
All agents episode reward: [-5.68826397]
Agent gate_2 episode reward: [-6.28366863]
All agents episode reward: [-6.28366863]
Agent gate_2 episode reward: [-5.835849]
All agents episode reward: [-5.835849]
Iteration 3:  53%|█████▎    | 16/30 [00:37<00:33,  2.38s/it, episode=100, norm_ret=-5.065, true_ret=-84909896.000, steps=600]
Agent gate_2 episode reward: [-5.8206925]
All agents episode reward: [-5.8206925]
Agent gate_2 episode reward: [-6.11537961]
All agents episode reward: [-6.11537961]
Agent gate_2 episode reward: [-6.62675813]
All agents episode reward: [-6.62675813]
Agent gate_2 episode reward: [-6.17359085]
All agents episode reward: [-6.17359085]
Agent gate_2 episode reward: [-5.64257497]
All agents episode reward: [-5.64257497]
Agent gate_2 episode reward: [-6.0635857]
All agents episode reward: [-6.0635857]
Agent gate_2 episode reward: [-1.25770296]
All agents episode reward: [-1.25770296]
Agent gate_2 episode reward: [-3.82638454]
All agents episode reward: [-3.82638454]
Agent gate_2 episode reward: [-7.91220565]
All agents episode reward: [-7.91220565]
Agent gate_2 episode reward: [-1.2070321]
All agents episode reward: [-1.2070321]
Agent gate_2 episode reward: [-7.5032671]
All agents episode reward: [-7.5032671]
Agent gate_2 episode reward: [-6.28930779]
All agents episode reward: [-6.28930779]
Agent gate_2 episode reward: [-6.4673559]
All agents episode reward: [-6.4673559]
Agent gate_2 episode reward: [0.]
All agents episode reward: [0.]
Agent gate_2 episode reward: [-5.28980513]
All agents episode reward: [-5.28980513]
Agent gate_2 episode reward: [-6.14234719]
All agents episode reward: [-6.14234719]
Agent gate_2 episode reward: [-5.11438095]
All agents episode reward: [-5.11438095]
Agent gate_2 episode reward: [-6.94555066]
All agents episode reward: [-6.94555066]
Agent gate_2 episode reward: [-4.40575038]
All agents episode reward: [-4.40575038]
Agent gate_2 episode reward: [-6.33849615]
All agents episode reward: [-6.33849615]
Agent gate_2 episode reward: [-0.07772941]
All agents episode reward: [-0.07772941]
Agent gate_2 episode reward: [-5.82604284]
All agents episode reward: [-5.82604284]
Agent gate_2 episode reward: [-7.39139572]
All agents episode reward: [-7.39139572]
Agent gate_2 episode reward: [-4.38463785]
All agents episode reward: [-4.38463785]
Agent gate_2 episode reward: [-6.38451733]
All agents episode reward: [-6.38451733]
Agent gate_2 episode reward: [-7.44866724]
All agents episode reward: [-7.44866724]
Agent gate_2 episode reward: [-5.50306977]
All agents episode reward: [-5.50306977]
Agent gate_2 episode reward: [-6.83454223]
All agents episode reward: [-6.83454223]
Agent gate_2 episode reward: [-3.4000842]
All agents episode reward: [-3.4000842]
Agent gate_2 episode reward: [-5.45179028]
All agents episode reward: [-5.45179028]
Iteration 4:  53%|█████▎    | 16/30 [00:37<00:32,  2.35s/it, episode=130, norm_ret=-4.645, true_ret=-319343584.000, steps=600]
Agent gate_2 episode reward: [-5.48914483]
All agents episode reward: [-5.48914483]
Agent gate_2 episode reward: [-5.67293966]
All agents episode reward: [-5.67293966]
Agent gate_2 episode reward: [-5.47993704]
All agents episode reward: [-5.47993704]
Agent gate_2 episode reward: [0.]
All agents episode reward: [0.]
Agent gate_2 episode reward: [-8.23627639]
All agents episode reward: [-8.23627639]
Agent gate_2 episode reward: [0.]
All agents episode reward: [0.]
Agent gate_2 episode reward: [-6.43814137]
All agents episode reward: [-6.43814137]
Agent gate_2 episode reward: [-2.6757875]
All agents episode reward: [-2.6757875]
Agent gate_2 episode reward: [-7.50793058]
All agents episode reward: [-7.50793058]
Agent gate_2 episode reward: [-4.94972305]
All agents episode reward: [-4.94972305]
Agent gate_2 episode reward: [-4.82359834]
All agents episode reward: [-4.82359834]
Agent gate_2 episode reward: [-7.37317803]
All agents episode reward: [-7.37317803]
Agent gate_2 episode reward: [0.]
All agents episode reward: [0.]
Agent gate_2 episode reward: [-4.55743705]
All agents episode reward: [-4.55743705]
Agent gate_2 episode reward: [-1.87815847]
All agents episode reward: [-1.87815847]
Agent gate_2 episode reward: [-5.99833536]
All agents episode reward: [-5.99833536]
Agent gate_2 episode reward: [-1.61859917]
All agents episode reward: [-1.61859917]
Agent gate_2 episode reward: [-4.73700422]
All agents episode reward: [-4.73700422]
Agent gate_2 episode reward: [-2.5475291]
All agents episode reward: [-2.5475291]
Agent gate_2 episode reward: [-6.33523625]
All agents episode reward: [-6.33523625]
Agent gate_2 episode reward: [-1.83295077]
All agents episode reward: [-1.83295077]
Agent gate_2 episode reward: [-6.25217047]
All agents episode reward: [-6.25217047]
Agent gate_2 episode reward: [-7.87132978]
All agents episode reward: [-7.87132978]
Agent gate_2 episode reward: [-4.84652244]
All agents episode reward: [-4.84652244]
Agent gate_2 episode reward: [0.]
All agents episode reward: [0.]
Agent gate_2 episode reward: [-6.12368799]
All agents episode reward: [-6.12368799]
Agent gate_2 episode reward: [-8.36503211]
All agents episode reward: [-8.36503211]
Agent gate_2 episode reward: [0.]
All agents episode reward: [0.]
Agent gate_2 episode reward: [-6.18078842]
All agents episode reward: [-6.18078842]
Agent gate_2 episode reward: [-2.31439174]
All agents episode reward: [-2.31439174]
Iteration 5:  47%|████▋     | 14/30 [00:48<00:48,  3.03s/it, episode=160, norm_ret=-4.626, true_ret=-408969792.000, steps=600]
Agent gate_2 episode reward: [-2.01472425]
All agents episode reward: [-2.01472425]
Agent gate_2 episode reward: [-1.55180877]
All agents episode reward: [-1.55180877]
Agent gate_2 episode reward: [0.]
All agents episode reward: [0.]
Agent gate_2 episode reward: [-4.54745955]
All agents episode reward: [-4.54745955]
Saved 1 agents to ppo_agents_butterfly_scC
[Validation] New best avg return: -354180032.000 at episode 155 (over 10 val episodes, saved to ppo_agents_butterfly_scC)
Agent gate_2 episode reward: [-6.63415822]
All agents episode reward: [-6.63415822]
Agent gate_2 episode reward: [-7.70129989]
All agents episode reward: [-7.70129989]
Agent gate_2 episode reward: [-4.34898916]
All agents episode reward: [-4.34898916]
Agent gate_2 episode reward: [-6.58496019]
All agents episode reward: [-6.58496019]
Agent gate_2 episode reward: [-5.97940871]
All agents episode reward: [-5.97940871]
Saved 1 agents to ppo_agents_butterfly_scC
[Validation] New best avg return: -290076576.000 at episode 160 (over 10 val episodes, saved to ppo_agents_butterfly_scC)
Agent gate_2 episode reward: [-6.89507884]
All agents episode reward: [-6.89507884]
Agent gate_2 episode reward: [-4.18103559]
All agents episode reward: [-4.18103559]
Agent gate_2 episode reward: [-0.87562457]
All agents episode reward: [-0.87562457]
Agent gate_2 episode reward: [-2.81613668]
All agents episode reward: [-2.81613668]
Agent gate_2 episode reward: [-5.81208249]
All agents episode reward: [-5.81208249]
Agent gate_2 episode reward: [0.]
All agents episode reward: [0.]
Agent gate_2 episode reward: [-5.30816876]
All agents episode reward: [-5.30816876]
Agent gate_2 episode reward: [-5.94011508]
All agents episode reward: [-5.94011508]
Agent gate_2 episode reward: [0.]
All agents episode reward: [0.]
Agent gate_2 episode reward: [-3.84682453]
All agents episode reward: [-3.84682453]
Agent gate_2 episode reward: [-1.88390828]
All agents episode reward: [-1.88390828]
Agent gate_2 episode reward: [-6.3230729]
All agents episode reward: [-6.3230729]
Agent gate_2 episode reward: [-7.91710028]
All agents episode reward: [-7.91710028]
Agent gate_2 episode reward: [-7.53730567]
All agents episode reward: [-7.53730567]
Agent gate_2 episode reward: [-3.0214664]
All agents episode reward: [-3.0214664]
Agent gate_2 episode reward: [-7.87691283]
All agents episode reward: [-7.87691283]
Agent gate_2 episode reward: [-6.68285676]
All agents episode reward: [-6.68285676]
Agent gate_2 episode reward: [0.]
All agents episode reward: [0.]
Agent gate_2 episode reward: [-10.78730998]
All agents episode reward: [-10.78730998]
Agent gate_2 episode reward: [-7.61632673]
All agents episode reward: [-7.61632673]
Agent gate_2 episode reward: [-7.85644126]
All agents episode reward: [-7.85644126]
Iteration 6:  50%|█████     | 15/30 [01:00<01:21,  5.44s/it, episode=190, norm_ret=-7.150, true_ret=-329653312.000, steps=600]
Agent gate_2 episode reward: [-8.69300604]
All agents episode reward: [-8.69300604]
Agent gate_2 episode reward: [-9.02534381]
All agents episode reward: [-9.02534381]
Agent gate_2 episode reward: [-4.43532399]
All agents episode reward: [-4.43532399]
Agent gate_2 episode reward: [-7.45896941]
All agents episode reward: [-7.45896941]
Agent gate_2 episode reward: [-7.26997849]
All agents episode reward: [-7.26997849]
Agent gate_2 episode reward: [-5.34518451]
All agents episode reward: [-5.34518451]
Agent gate_2 episode reward: [-6.71447238]
All agents episode reward: [-6.71447238]
Agent gate_2 episode reward: [-7.68666606]
All agents episode reward: [-7.68666606]
Agent gate_2 episode reward: [-8.60305247]
All agents episode reward: [-8.60305247]
Saved 1 agents to ppo_agents_butterfly_scC
[Validation] New best avg return: -236480768.000 at episode 190 (over 10 val episodes, saved to ppo_agents_butterfly_scC)
Agent gate_2 episode reward: [-6.27180548]
All agents episode reward: [-6.27180548]
Agent gate_2 episode reward: [0.]
All agents episode reward: [0.]
Agent gate_2 episode reward: [-3.89112305]
All agents episode reward: [-3.89112305]
Agent gate_2 episode reward: [-7.63976919]
All agents episode reward: [-7.63976919]
Agent gate_2 episode reward: [-7.36412516]
All agents episode reward: [-7.36412516]
Agent gate_2 episode reward: [-5.53578666]
All agents episode reward: [-5.53578666]
Agent gate_2 episode reward: [-6.4122959]
All agents episode reward: [-6.4122959]
Agent gate_2 episode reward: [-3.55121679]
All agents episode reward: [-3.55121679]
Agent gate_2 episode reward: [-8.85609657]
All agents episode reward: [-8.85609657]
Agent gate_2 episode reward: [-9.34362769]
All agents episode reward: [-9.34362769]
Agent gate_2 episode reward: [-8.02492994]
All agents episode reward: [-8.02492994]
Agent gate_2 episode reward: [-7.44626091]
All agents episode reward: [-7.44626091]
Agent gate_2 episode reward: [-4.56063859]
All agents episode reward: [-4.56063859]
Agent gate_2 episode reward: [-6.73315582]
All agents episode reward: [-6.73315582]
Agent gate_2 episode reward: [-3.59922192]
All agents episode reward: [-3.59922192]
Agent gate_2 episode reward: [-5.85767383]
All agents episode reward: [-5.85767383]
Agent gate_2 episode reward: [-8.64893702]
All agents episode reward: [-8.64893702]
Agent gate_2 episode reward: [-8.00321887]
All agents episode reward: [-8.00321887]
Agent gate_2 episode reward: [-8.22415675]
All agents episode reward: [-8.22415675]
Agent gate_2 episode reward: [-2.57761958]
All agents episode reward: [-2.57761958]
Agent gate_2 episode reward: [0.]
All agents episode reward: [0.]
Iteration 7:  53%|█████▎    | 16/30 [01:03<01:02,  4.50s/it, episode=220, norm_ret=-5.839, true_ret=-324017664.000, steps=600]
Agent gate_2 episode reward: [-7.23863657]
All agents episode reward: [-7.23863657]
Agent gate_2 episode reward: [-3.91670487]
All agents episode reward: [-3.91670487]
Agent gate_2 episode reward: [-7.01105202]
All agents episode reward: [-7.01105202]
Agent gate_2 episode reward: [-7.88949576]
All agents episode reward: [-7.88949576]
Agent gate_2 episode reward: [-4.54111378]
All agents episode reward: [-4.54111378]
Agent gate_2 episode reward: [-4.44509126]
All agents episode reward: [-4.44509126]
Agent gate_2 episode reward: [-1.20779457]
All agents episode reward: [-1.20779457]
Agent gate_2 episode reward: [-8.67689596]
All agents episode reward: [-8.67689596]
Agent gate_2 episode reward: [-6.79375303]
All agents episode reward: [-6.79375303]
Agent gate_2 episode reward: [-6.67421997]
All agents episode reward: [-6.67421997]
Agent gate_2 episode reward: [-9.36908489]
All agents episode reward: [-9.36908489]
Agent gate_2 episode reward: [-7.47309243]
All agents episode reward: [-7.47309243]
Agent gate_2 episode reward: [-8.01414709]
All agents episode reward: [-8.01414709]
Agent gate_2 episode reward: [-8.32821188]
All agents episode reward: [-8.32821188]
Agent gate_2 episode reward: [-7.82440473]
All agents episode reward: [-7.82440473]
Agent gate_2 episode reward: [-10.17211224]
All agents episode reward: [-10.17211224]
Agent gate_2 episode reward: [-8.95103553]
All agents episode reward: [-8.95103553]
Agent gate_2 episode reward: [-7.58544539]
All agents episode reward: [-7.58544539]
Agent gate_2 episode reward: [-0.67900557]
All agents episode reward: [-0.67900557]
Agent gate_2 episode reward: [-9.94656922]
All agents episode reward: [-9.94656922]
Agent gate_2 episode reward: [-6.74719677]
All agents episode reward: [-6.74719677]
Agent gate_2 episode reward: [-7.09156366]
All agents episode reward: [-7.09156366]
Agent gate_2 episode reward: [-154.57316351]
All agents episode reward: [-154.57316351]
Agent gate_2 episode reward: [-5.43026855]
All agents episode reward: [-5.43026855]
Agent gate_2 episode reward: [-343.6000817]
All agents episode reward: [-343.6000817]
Agent gate_2 episode reward: [-0.00080848]
All agents episode reward: [-0.00080848]
Agent gate_2 episode reward: [-0.02868912]
All agents episode reward: [-0.02868912]
Agent gate_2 episode reward: [-0.0198618]
All agents episode reward: [-0.0198618]
Agent gate_2 episode reward: [-0.00049328]
All agents episode reward: [-0.00049328]
Agent gate_2 episode reward: [-0.00053354]
All agents episode reward: [-0.00053354]
Iteration 8:  53%|█████▎    | 16/30 [01:03<01:02,  4.43s/it, episode=250, norm_ret=-0.002, true_ret=-987084032.000, steps=600]
Agent gate_2 episode reward: [-0.0011788]
All agents episode reward: [-0.0011788]
Agent gate_2 episode reward: [-0.00100661]
All agents episode reward: [-0.00100661]
Agent gate_2 episode reward: [-0.00416752]
All agents episode reward: [-0.00416752]
Agent gate_2 episode reward: [-0.00108789]
All agents episode reward: [-0.00108789]
Agent gate_2 episode reward: [-0.00179173]
All agents episode reward: [-0.00179173]
Agent gate_2 episode reward: [-0.00137602]
All agents episode reward: [-0.00137602]
Agent gate_2 episode reward: [-0.00075193]
All agents episode reward: [-0.00075193]
Agent gate_2 episode reward: [-0.00079857]
All agents episode reward: [-0.00079857]
Agent gate_2 episode reward: [-0.00375847]
All agents episode reward: [-0.00375847]
Agent gate_2 episode reward: [-0.00251285]
All agents episode reward: [-0.00251285]
Agent gate_2 episode reward: [-0.00128226]
All agents episode reward: [-0.00128226]
Agent gate_2 episode reward: [-0.00636347]
All agents episode reward: [-0.00636347]
Agent gate_2 episode reward: [-0.00532958]
All agents episode reward: [-0.00532958]
Agent gate_2 episode reward: [-0.00421059]
All agents episode reward: [-0.00421059]
Agent gate_2 episode reward: [-0.00339408]
All agents episode reward: [-0.00339408]
Agent gate_2 episode reward: [-0.00476002]
All agents episode reward: [-0.00476002]
Agent gate_2 episode reward: [-0.00609068]
All agents episode reward: [-0.00609068]
Agent gate_2 episode reward: [-0.00672798]
All agents episode reward: [-0.00672798]
Agent gate_2 episode reward: [-0.00561239]
All agents episode reward: [-0.00561239]
Agent gate_2 episode reward: [-0.0058736]
All agents episode reward: [-0.0058736]
Agent gate_2 episode reward: [-0.00568808]
All agents episode reward: [-0.00568808]
Agent gate_2 episode reward: [-0.00528961]
All agents episode reward: [-0.00528961]
Agent gate_2 episode reward: [-0.0060737]
All agents episode reward: [-0.0060737]
Agent gate_2 episode reward: [-0.00680559]
All agents episode reward: [-0.00680559]
Agent gate_2 episode reward: [-0.00658683]
All agents episode reward: [-0.00658683]
Agent gate_2 episode reward: [-0.00620992]
All agents episode reward: [-0.00620992]
Agent gate_2 episode reward: [-0.00701336]
All agents episode reward: [-0.00701336]
Agent gate_2 episode reward: [-0.00461623]
All agents episode reward: [-0.00461623]
Agent gate_2 episode reward: [-0.00552016]
All agents episode reward: [-0.00552016]
Agent gate_2 episode reward: [-0.00563465]
All agents episode reward: [-0.00563465]
Iteration 9:  53%|█████▎    | 16/30 [01:03<01:03,  4.52s/it, episode=280, norm_ret=-0.005, true_ret=-1873867520.000, steps=600]
Agent gate_2 episode reward: [-0.00274041]
All agents episode reward: [-0.00274041]
Agent gate_2 episode reward: [-0.00361756]
All agents episode reward: [-0.00361756]
Agent gate_2 episode reward: [-0.00597058]
All agents episode reward: [-0.00597058]
Agent gate_2 episode reward: [-0.00567493]
All agents episode reward: [-0.00567493]
Agent gate_2 episode reward: [-0.00609955]
All agents episode reward: [-0.00609955]
Agent gate_2 episode reward: [-0.00518604]
All agents episode reward: [-0.00518604]
Agent gate_2 episode reward: [-0.00617281]
All agents episode reward: [-0.00617281]
Agent gate_2 episode reward: [-0.00613928]
All agents episode reward: [-0.00613928]
Agent gate_2 episode reward: [-0.00507276]
All agents episode reward: [-0.00507276]
Agent gate_2 episode reward: [-0.00523525]
All agents episode reward: [-0.00523525]
Agent gate_2 episode reward: [-0.00376163]
All agents episode reward: [-0.00376163]
Agent gate_2 episode reward: [-0.00213318]
All agents episode reward: [-0.00213318]
Agent gate_2 episode reward: [-0.00607234]
All agents episode reward: [-0.00607234]
Agent gate_2 episode reward: [-0.00437566]
All agents episode reward: [-0.00437566]
Agent gate_2 episode reward: [-0.00543766]
All agents episode reward: [-0.00543766]
Agent gate_2 episode reward: [-0.00423027]
All agents episode reward: [-0.00423027]
Agent gate_2 episode reward: [-0.00530956]
All agents episode reward: [-0.00530956]
Agent gate_2 episode reward: [-0.00658543]
All agents episode reward: [-0.00658543]
Agent gate_2 episode reward: [-0.00401643]
All agents episode reward: [-0.00401643]
Agent gate_2 episode reward: [-0.00824861]
All agents episode reward: [-0.00824861]
Agent gate_2 episode reward: [-0.00459147]
All agents episode reward: [-0.00459147]
Agent gate_2 episode reward: [-0.00565324]
All agents episode reward: [-0.00565324]
Agent gate_2 episode reward: [-0.00747455]
All agents episode reward: [-0.00747455]
Agent gate_2 episode reward: [-0.00855573]
All agents episode reward: [-0.00855573]
Agent gate_2 episode reward: [-0.01010856]
All agents episode reward: [-0.01010856]
Agent gate_2 episode reward: [-0.00744405]
All agents episode reward: [-0.00744405]
Agent gate_2 episode reward: [-0.0103275]
All agents episode reward: [-0.0103275]
Agent gate_2 episode reward: [-0.0098619]
All agents episode reward: [-0.0098619]
Agent gate_2 episode reward: [-0.0093148]
All agents episode reward: [-0.0093148]
Agent gate_2 episode reward: [-0.00812798]
All agents episode reward: [-0.00812798]
Saved 1 agents to ppo_agents_butterfly_scC
Loaded 1 agents from ppo_agents_butterfly_scC
Running 10 evaluation runs...
  Run 1/10... Avg agent reward (episode): -3374167808.000 | Total reward: -3374167808.000
Saved run 1 to rl_training/butterfly_scC/ppo_run1
  Run 2/10... Avg agent reward (episode): -3491618304.000 | Total reward: -3491618304.000
Saved run 2 to rl_training/butterfly_scC/ppo_run2
  Run 3/10... Avg agent reward (episode): -3722174208.000 | Total reward: -3722174208.000
Saved run 3 to rl_training/butterfly_scC/ppo_run3
  Run 4/10... Avg agent reward (episode): -3846865664.000 | Total reward: -3846865664.000
Saved run 4 to rl_training/butterfly_scC/ppo_run4
  Run 5/10... Avg agent reward (episode): -3771094016.000 | Total reward: -3771094016.000
Saved run 5 to rl_training/butterfly_scC/ppo_run5
  Run 6/10... Avg agent reward (episode): -3750526720.000 | Total reward: -3750526720.000
Saved run 6 to rl_training/butterfly_scC/ppo_run6
  Run 7/10... Avg agent reward (episode): -3800660480.000 | Total reward: -3800660480.000
Saved run 7 to rl_training/butterfly_scC/ppo_run7
  Run 8/10... Avg agent reward (episode): -3855610880.000 | Total reward: -3855610880.000
Saved run 8 to rl_training/butterfly_scC/ppo_run8
  Run 9/10... Avg agent reward (episode): -3642679808.000 | Total reward: -3642679808.000
Saved run 9 to rl_training/butterfly_scC/ppo_run9
  Run 10/10... Avg agent reward (episode): -3059849728.000 | Total reward: -3059849728.000
Saved run 10 to rl_training/butterfly_scC/ppo_run10
============================================================
Evaluation Results
  Number of runs: 10
============================================================
  Agent gate_2: -3631524608.000 ± 240789264.000
  Average reward: -3631524608.000 ± 240789264.000
  Total reward: -3631524608.000 ± 240789264.000
============================================================
Running 10 evaluation runs...
  Run 1/10... Avg agent reward (episode): -407377344.000 | Total reward: -407377344.000
Saved run 1 to rl_training/butterfly_scC/rule_based_run1
  Run 2/10... Avg agent reward (episode): -724314624.000 | Total reward: -724314624.000
Saved run 2 to rl_training/butterfly_scC/rule_based_run2
  Run 3/10... Avg agent reward (episode): -805422336.000 | Total reward: -805422336.000
Saved run 3 to rl_training/butterfly_scC/rule_based_run3
  Run 4/10... Avg agent reward (episode): -1174821632.000 | Total reward: -1174821632.000
Saved run 4 to rl_training/butterfly_scC/rule_based_run4
  Run 5/10... Avg agent reward (episode): -1778629607424.000 | Total reward: -1778629607424.000
Saved run 5 to rl_training/butterfly_scC/rule_based_run5
  Run 6/10... Avg agent reward (episode): -791052160.000 | Total reward: -791052160.000
Saved run 6 to rl_training/butterfly_scC/rule_based_run6
  Run 7/10... Avg agent reward (episode): -822285120.000 | Total reward: -822285120.000
Saved run 7 to rl_training/butterfly_scC/rule_based_run7
  Run 8/10... Avg agent reward (episode): -2202740457472.000 | Total reward: -2202740457472.000
Saved run 8 to rl_training/butterfly_scC/rule_based_run8
  Run 9/10... Avg agent reward (episode): -744597440.000 | Total reward: -744597440.000
Saved run 9 to rl_training/butterfly_scC/rule_based_run9
  Run 10/10... Avg agent reward (episode): -499645216.000 | Total reward: -499645216.000
Saved run 10 to rl_training/butterfly_scC/rule_based_run10
============================================================
Evaluation Results
  Number of runs: 10
============================================================
  Agent gate_2: -398733934592.000 ± 801605025792.000
  Average reward: -398733934592.000 ± 801605025792.000
  Total reward: -398733934592.000 ± 801605025792.000
============================================================
Running 10 evaluation runs...
  Run 1/10... No actions provided, skipping action application.
Avg agent reward (episode): -212225136.000 | Total reward: -212225136.000
Saved run 1 to rl_training/butterfly_scC/no_control_run1
  Run 2/10... No actions provided, skipping action application.
Avg agent reward (episode): -368379040.000 | Total reward: -368379040.000
Saved run 2 to rl_training/butterfly_scC/no_control_run2
  Run 3/10... No actions provided, skipping action application.
Avg agent reward (episode): -424930720.000 | Total reward: -424930720.000
Saved run 3 to rl_training/butterfly_scC/no_control_run3
  Run 4/10... No actions provided, skipping action application.
Avg agent reward (episode): -509151424.000 | Total reward: -509151424.000
Saved run 4 to rl_training/butterfly_scC/no_control_run4
  Run 5/10... No actions provided, skipping action application.
Avg agent reward (episode): -340241952.000 | Total reward: -340241952.000
Saved run 5 to rl_training/butterfly_scC/no_control_run5
  Run 6/10... No actions provided, skipping action application.
Avg agent reward (episode): -424589088.000 | Total reward: -424589088.000
Saved run 6 to rl_training/butterfly_scC/no_control_run6
  Run 7/10... No actions provided, skipping action application.
Avg agent reward (episode): -454989280.000 | Total reward: -454989280.000
Saved run 7 to rl_training/butterfly_scC/no_control_run7
  Run 8/10... No actions provided, skipping action application.
Avg agent reward (episode): -372457056.000 | Total reward: -372457056.000
Saved run 8 to rl_training/butterfly_scC/no_control_run8
  Run 9/10... No actions provided, skipping action application.
Avg agent reward (episode): -388921664.000 | Total reward: -388921664.000
Saved run 9 to rl_training/butterfly_scC/no_control_run9
  Run 10/10... No actions provided, skipping action application.
Avg agent reward (episode): -282969408.000 | Total reward: -282969408.000
Saved run 10 to rl_training/butterfly_scC/no_control_run10
============================================================
Evaluation Results
  Number of runs: 10
============================================================
  Agent gate_2: -377885472.000 ± 81044008.000
  Average reward: -377885472.000 ± 81044008.000
  Total reward: -377885472.000 ± 81044008.000
============================================================

============================================================
Comparison of All Methods
============================================================
ppo avg reward:        -3631524608.000
Rule-based avg reward: -398733934592.000
No control avg reward: -377885472.000
============================================================
/Users/mmai/anaconda3/envs/control/lib/python3.11/site-packages/matplotlib/patches.py:3421: RuntimeWarning: invalid value encountered in scalar divide
  cos_t, sin_t = head_length / head_dist, head_width / head_dist
